<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Code Review_INFO7390_Face Recognition - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableDynamicAutoCompleteResourceLoading":false,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":true,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":true,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"4.0.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"fan.ju@husky.neu.edu","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"shouldShowCommandStatus":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db6-rc-scala2.10","displayName":"Spark 2.1.1-db6 RC (Scala 2.10)","packageLabel":"spark-image-a538ca364b98a239d3e3fdc6aec04be1e2a43a5048e892544ad36227f3c15e3e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-rc-scala2.10","displayName":"3.0 RC (Scala 2.10)","packageLabel":"spark-image-59387ea1f1ed4815e7fea55181b37031b706c9db7b12910538e426c36979776f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-22756288786762d246bac1381e4f44610a4c2c3135c717c5ac3661822a723f1c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-rc-scala2.11","displayName":"Spark 2.1.1-db5 RC (Scala 2.11)","packageLabel":"spark-image-2a33601117df30805171c95a6e55586ba2399d7c86bdc32a9de8638841e08bac","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-7ce07ae16a775d917d6748d2075807565c157286f4f5957c1b77275b3b2a9bc4","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-86a9b375074f5afad339e70230ec0ec265c4cefbd280844785fab3bcde5869f9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.1.x-scala2.11","displayName":"4.1 beta (Scala 2.11)","packageLabel":"spark-image-57255b6f34abb7ed8ae0cf9b53db8fe6c764fdf836be6d38e79d47412f3e78c6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-cdfb5c6299de6a2f4f5b75e8def2d11faa2026a8354185434873ec4612916663","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-4efc0c94e152791782f2cb865ac1eb3c11985a2671a77e6ef930f9718851459d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-ab147bdd6662fef83fa48e41d909aa045422585552758dc667f1971876c4486f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5 RC (Scala 2.11)","packageLabel":"spark-image-a2bddc1e90548bb6f99bf5ca4de157c9e89dcec7f5712c8fdaf3104077d88c1a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0 RC (Scala 2.11)","packageLabel":"spark-image-bfebdfce9b315891aade03ea4fb64f1185db795d32ae5dc1cc3345017235df85","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-f91cb0b3822c6641a9d346ef6c149118fb859b5e511ee01c31e958892ba23c7a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-25dac86138b91b354c5882419df5c45cd3695fb36b3a14ad63ff459cd7ae28b8","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-e50cbe4c0b0ad46930872eff4b69665890fd6a170e2b1a3e48c1cdea5823fd86","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-55e58ce35b3dd5fe8442b63fee4f85426f615f2f817afee2225d5e468b6c2dda","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-rc-scala2.10","displayName":"Spark 2.1.1-db4 RC (Scala 2.10)","packageLabel":"spark-image-492e1588a9cbf07314da7db558f3247ff6debaeff57820b1cb71d5877a9a55eb","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-rc-scala2.10","displayName":"Spark 2.1.1-db5 RC (Scala 2.10)","packageLabel":"spark-image-4b1331460c7e25653273fe11f7b0066416cc4c6f35128a0a240525da297dbe08","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-62365f2d91529bc1128d8968f33d07f5b8d75cf7305de9455bc970e6e1fecbb4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 beta, Scala 2.11)","packageLabel":"spark-image-57255b6f34abb7ed8ae0cf9b53db8fe6c764fdf836be6d38e79d47412f3e78c6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.1-db6-rc-scala2.11","displayName":"Spark 2.1.1-db6 RC (Scala 2.11)","packageLabel":"spark-image-c6c1dfbb30e859ecb0f836cb5cf8dab1afcaf2befcb2ca0f7fff79d5212340be","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-0adabd34980ecfcbc6a48ac5c9e3a954cf5ec3a53a3300ae0e392c03299d89ca","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3 RC (Scala 2.11)","packageLabel":"spark-image-838e55612c3c6347cd7815dedca4c386a10b58e8613a26dc074bbfc5738859b8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4 RC (Scala 2.11)","packageLabel":"spark-image-ca29e775eb00e2eeff19eb4bd85245c6f1f83d721b94eb003ffcd6c4e2a3e600","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.1.x-rc-scala2.11","displayName":"4.1 RC (Scala 2.11)","packageLabel":"spark-image-57255b6f34abb7ed8ae0cf9b53db8fe6c764fdf836be6d38e79d47412f3e78c6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-f6652dabf371848f093b31dbbc5d0857be961eade11cecc833bbec2fb9e5fdfa","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.1-db4-rc-scala2.11","displayName":"Spark 2.1.1-db4 RC (Scala 2.11)","packageLabel":"spark-image-de7a16bf2274fcce0e9195e979b377ec38c9333bc22b39e41c7f8e884c68a887","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-fe8300ae2b3bf12c79ce76d7e9d2d03995e58d1497cfb6c0d3172efb630cb2df","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0 RC (GPU, Scala 2.11)","packageLabel":"spark-image-634013e73a566b1d38ab716e508917ac967aaafa070c4f7738d40a3284eee398","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.1.x-gpu-scala2.11","displayName":"4.1 beta (GPU, Scala 2.11)","packageLabel":"spark-image-3601f7346740bc3cdbdb4e64b5ac4793bb234fe05ea179269786e5e0a3fb41ea","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3 RC (Scala 2.10)","packageLabel":"spark-image-88696953357ab3fd5b94605cb9b2cff0579ae6902b66ef83bef33feaa08e1cf7","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-0112f566715b00d5aceb1b98543285bcb3a0f38174b86abd1c096c3e861043eb","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"[DEPRECATED] Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4 RC (Scala 2.10)","packageLabel":"spark-image-2a2d1c1656e095672e22fa356594f0c012075f6064023b8c314e8ca22222c906","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.1.x-rc-scala2.10","displayName":"3.1 RC (Scala 2.10)","packageLabel":"spark-image-0224bd872335869299c1fe5ccb942b8693bcfd9d749e8622ce79f6b9f6c67abd","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-07da7d24ad964d7a43f53bd9feac55de7df890ef6e5f6bac8975fb7aa3e2a0a7","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-66d1366768039140a9f5409f3bab414cb7477ebd8d4bbf8b32cb885120f9f705","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.2 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-e0c961f4f7cdde1ef14b43d807b44c7aae353c8a1700e219a1bebb1c7f9fb5c3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.2.x-rc-scala2.11","displayName":"3.2 RC (Scala 2.11)","packageLabel":"spark-image-ff28565c3cdd56ec95eb312f5b1327bc289ccb6bcd0460a1d914e0bca290c164","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-2fdca45e0fcac7081823a5faef4f25d6fc909d11c44eca82e1dd18e9d2ef2859","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-cdfb5c6299de6a2f4f5b75e8def2d11faa2026a8354185434873ec4612916663","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0d3a99d46a4c55642850b5eba9aad3b56ffb9adbe8c8893403eba834399960fc","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-1f615934d3e248da8dcfb3e03bd8d92e933a17845fedb7cce12af2a0220ba6a2","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-rc-scala2.11","displayName":"3.0 RC (Scala 2.11)","packageLabel":"spark-image-5320f602e164c1984eff3e156f4080782afa8946baf9506b2e911375d524b190","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-7faed5d78ac4a90e12affa8d1368a3346a2d82d0244fff9441be6a9f96db3b86","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-c6b477859faf291f56ac2dcbe6f6693d60e403c12dfcac58892b4014614363c3","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-46cc39a9afa43fbd7bfa9f4f5ed8d23f658cd0b0d74208627243222ae0d22f8d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-c8547fab0cc66b918f9a64c7e35532de209d0d0e06da6078ad787ec718b37e7b","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-0067951c626cad90625cce4d2dcf3e00a1029375f8e5470d2330036d0d3c505f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-b512ba976616af10269438701339a9bd5a97cc386737c6ecffdda5fb31c3cf20","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.1.x-rc-scala2.11","displayName":"3.1 RC (Scala 2.11)","packageLabel":"spark-image-49e87eb5179293964bfb9c1f4f5c000c4a6f3e75af93c59c5b544c25bc7e6c04","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.1.x-rc-gpu-scala2.11","displayName":"4.1 RC (GPU, Scala 2.11)","packageLabel":"spark-image-3601f7346740bc3cdbdb4e64b5ac4793bb234fe05ea179269786e5e0a3fb41ea","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.2 snapshot, Scala 2.11)","packageLabel":"spark-image-d9b06b87f3d139dadfd4f2b9aaa41d0ef2c52163fd2d35c688311b18c79c588c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS","SUPPORTS_RSTUDIO"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-3b22b5c8d5577281bcca8dd6ef07553fb32b3b99ab977f8bdb7238f850ece887","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-2fdca45e0fcac7081823a5faef4f25d6fc909d11c44eca82e1dd18e9d2ef2859","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-0ea14d4a8a71de38872dd398b1139d55302680cfe3e9da217576c8304cd19b24","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 beta, GPU, Scala 2.11)","packageLabel":"spark-image-3601f7346740bc3cdbdb4e64b5ac4793bb234fe05ea179269786e5e0a3fb41ea","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_RSTUDIO"]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5 RC (Scala 2.10)","packageLabel":"spark-image-8cd5632d6638005581897bab71ed26e3b29e3290188381998e67283b6a82f468","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-867d7300605c0c54b2b1394d1bba7b88b28ed5841b3575253cded34db6ce6454","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.2.x-rc-scala2.10","displayName":"3.2 RC (Scala 2.10)","packageLabel":"spark-image-6a7492d752ad9000040dfc824fd2368915950dae8bb70ee5fdfce6bef4366311","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":false,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"Standard_E64s_v3":16,"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"Standard_D11_v2":0.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_NC6":2,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_D13_v2":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_NC24":8,"Standard_NC24r":8,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_D14_v2":4,"Standard_H16":4,"Standard_NC12":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_D15_v2":5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"Standard_D12_v2":1,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"Standard_D4_v2":1.5,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.69.54","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":1000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":false,"enableCustomSpotPricing":false,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":100,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":true,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"fan.ju@husky.neu.edu","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true","spark.databricks.repl.allowedLanguages":"python,sql"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https?://(docs\\.databricks\\.com/_static/notebooks/|files\\.training\\.databricks\\.com/).+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":true,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableUserPromptForPendingRpc":true,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":971216357823437,"name":"Code Review_INFO7390_Face Recognition","language":"python","commands":[{"version":"CommandV1","origId":971216357823438,"guid":"fb7c788e-9640-454b-9901-7ddef6d9d16c","subtype":"command","commandType":"auto","position":1.0,"command":"%md #**Face Recognition Using Convolutional Neural Network**\n\n- --------------","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446626121,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2b0358cd-3568-4127-a881-8217ff2fb4c5"},{"version":"CommandV1","origId":971216357823442,"guid":"f064a596-cb59-4551-bbf7-30dbc97b214a","subtype":"command","commandType":"auto","position":1.75,"command":"%md\n##Work FLow\n- -----\n###I. Import Libiaries \nYou can run this notebook on databricks, after create libraries: *keras*, *opencv-python*.\nOr, you can run this notebook locally. Anaconda is a good choice.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446626365,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"054c0793-9175-41e0-bd2c-5fb9aa5faa53"},{"version":"CommandV1","origId":971216357823443,"guid":"d0dde307-0f8f-4f0e-82c2-687448cb41a8","subtype":"command","commandType":"auto","position":2.0,"command":"import os\nimport sys\nimport numpy as np\nimport cv2\nimport random\nimport numpy as np\nimport keras\nfrom sklearn.cross_validation import train_test_split\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Activation, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras.optimizers import SGD\nfrom keras.utils import np_utils\nfrom keras.models import load_model\nfrom keras import optimizers\nfrom keras import backend as K\nimport h5py \nfrom keras.models import model_from_json \nimport matplotlib.pyplot as plt\nimport pandas as pd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/databricks/python/local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from &#96;float&#96; to &#96;np.floating&#96; is deprecated. In future, it will be treated as &#96;np.float64 == np.dtype(float).type&#96;.\n  from ._conv import register_converters as _register_converters\nUsing TensorFlow backend.\n/databricks/python/local/lib/python2.7/site-packages/sklearn/cross_validation.py:44: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.\n  &quot;This module will be removed in 0.20.&quot;, DeprecationWarning)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524446631042,"submitTime":1524446626481,"finishTime":1524446634261,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8144742f-b5b0-42f5-9922-a2b3d4845ef8"},{"version":"CommandV1","origId":971216357823444,"guid":"c9ad21a8-7fb5-4fe5-b9dd-b57b389dc1d7","subtype":"command","commandType":"auto","position":2.5,"command":"%md ###II. Image Processing\nThe input shape of a CNN has rule, so before build our model, we need to process image dataset. We want to read graphs one by one, normalization, and add different labels to each of them according to the person shows on it, like ‘0’ for A and ‘1’ for B. \n\nWe use OpenCV, which has an image processing module that includes linear and non-linear image filtering, geometrical image transformations (resize, affine and perspective warping, generic table-based remapping), color space conversion, histograms, and so on. to adjust our images.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446626594,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8905e44c-cfb8-4227-9d41-f062ffcb97cd"},{"version":"CommandV1","origId":971216357823445,"guid":"20aff932-6c7c-497c-8ad3-3360573a2d2b","subtype":"command","commandType":"auto","position":2.875,"command":"%md \n![image processing](https://raw.githubusercontent.com/JunxiFan/Big-Data-Systems-and-Intelligence-Analytics/master/image_portfolio/image_processing.jpg)\n\nWhen we read an image, suppose we have x pixel wide and y height image. OpenCV can read an image file and coverts it to a list (width × height × 3, 3 means three channels of colors as red, green, blue). To normalize the input data shape of our neural network model, for one images, we compare the width and height, and add borders to the shorter sides. At last, we resized the picture to 32 × 32 pixels format. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446626714,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a4743fda-d084-4496-9c4a-f8e984d618fa"},{"version":"CommandV1","origId":971216357823446,"guid":"86295032-4a40-4134-beda-913c30ed3df8","subtype":"command","commandType":"auto","position":3.0,"command":"IMAGE_SIZE = 64\n\ndef resize_image(image, height_output = IMAGE_SIZE, width_output = IMAGE_SIZE):\n     # initialize border's value. default value of four borders is 0\n    top, bottom, left, right = (0, 0, 0, 0)\n    \n    #get image's size\n    width, height, _ = image.shape\n    \n    #find the longer side of the image\n    longer_side = max(width, height)    \n    \n    #calculate how many we should add to the shorter side\n    if width < longer_side:\n        dh = longer_side - width\n        top = dh // 2\n        bottom = dh - top\n    elif height < longer_side:\n        dw = longer_side - height\n        left = dw // 2\n        right = dw - left\n    else:\n        pass \n    \n    #RGB\n    BLACK = [0, 0, 0]\n\n    # add border to make two sides the same. \"cv2.BORDER_CONSTANT \" is the color of border, configured by \"value\"\n    constant = cv2.copyMakeBorder(image, top , bottom, left, right, cv2.BORDER_CONSTANT, value = BLACK)\n    \n    return cv2.resize(constant, (height_output, width_output))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524446634333,"submitTime":1524446626830,"finishTime":1524446634413,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f9b618f2-54d6-4e5a-bbb8-6f2dae6eb78e"},{"version":"CommandV1","origId":971216357823447,"guid":"bd211b6d-f57d-4b49-8bc1-8b7787d0eab5","subtype":"command","commandType":"auto","position":4.0,"command":"%md How to read hundreds of images with labels into our project is the next problem. Now we have many graphs of two people, for example, Johnny Depp and Natalie Portman, separated in two folders.  After doing this classification, we can get a list of images and a list of related labels. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446626943,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"48f59c9c-b60c-427e-88d6-b1370a51d9f7"},{"version":"CommandV1","origId":971216357823448,"guid":"c49c1bc2-b198-4e5d-9c7e-6e34147fb464","subtype":"command","commandType":"auto","position":5.0,"command":"#read data into ram\nimages = []\nlabels = []\ndef read_path(path_url):    \n    for dir_item in os.listdir(path_url):\n        full_path = os.path.abspath(os.path.join(path_url, dir_item))\n        \n        if os.path.isdir(full_path):    #if it is a folder, continue. (here a recursion is used)\n            read_path(full_path)\n        else: \n            if dir_item.endswith('.jpg'):\n                image = cv2.imread(full_path)                \n                image = resize_image(image, IMAGE_SIZE, IMAGE_SIZE)\n                images.append(image)                \n                labels.append(path_url)                                \n                    \n    return images,labels\n    \n#main function, read data\ndef load_dataset(path_url):\n    images,labels = read_path(path_url)\n  \n    #change images to 4-dimensions array\n    images = np.array(images)\n#     print(images.shape,\"total \")\n    \n    labels = np.array([0 if label.endswith('johnny_depp') else 1 for label in labels])    \n    return images, labels","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524446634421,"submitTime":1524446627070,"finishTime":1524446634510,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"32cfdcef-6ce9-4e92-a3e8-1d4a408367e6"},{"version":"CommandV1","origId":971216357823449,"guid":"2bd39048-2f61-4a70-9266-e0929909d901","subtype":"command","commandType":"auto","position":6.0,"command":"%md We will do cross validation after training, so we split our dataset into three parts: Training, validation, and test sets. \n\nAlso, as it is a project about recognition, it’s necessary to do one-hot encoding to the labels. Label sets' shape will be a 2 dimention list, depends on the value of *nb_classes*. \n\nNext, change data type to float32 and normalize the value of RGB between 0-1, to improve network convergence speed, reduce training time, and reduce the value of training error.\n\nFor now, the preparation function before building CNN is complete. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446627184,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e92f673f-5770-4cce-b159-eb4a2f60e6ae"},{"version":"CommandV1","origId":971216357823450,"guid":"b52f522d-03dd-4c5f-958c-da2d8b91ccf6","subtype":"command","commandType":"auto","position":7.0,"command":"class Dataset:\n    def __init__(self, path_url):\n        #train data\n        self.train_images = None\n        self.train_labels = None\n        \n        #validate data\n        self.valid_images = None\n        self.valid_labels = None\n        \n        #test data\n        self.test_images  = None            \n        self.test_labels  = None\n        \n        #path of dataset\n        self.path_url = path_url\n        \n        #tensorflow (channels,rows,cols) or theano (rows,cols,channels)\n        self.input_shape = None\n        \n    # load dataset, then seperate dataset according to cross-validation\n    def load(self, nb_classes = 2):\n        #load dataset to ram\n        images, labels = load_dataset(self.path_url)        \n        \n        # split into three sets randomly\n        train_images, valid_images, train_labels, valid_labels = train_test_split(images, labels, test_size = 0.3, random_state = random.randint(0, 100))\n\n        _, test_images, _, test_labels = train_test_split(images, labels, test_size = 0.5, random_state = random.randint(0, 100))\n\n        self.input_shape = (IMAGE_SIZE, IMAGE_SIZE, 3)            \n            \n        #the amount of three data parts\n        print(train_images.shape[0], 'train samples')\n        print(valid_images.shape[0], 'valid samples')\n        print(test_images.shape[0], 'test samples')\n        \n        # label ===(one-hot encoding)===> 2 dimensions data\n        train_labels = np_utils.to_categorical(train_labels, nb_classes)                        \n        valid_labels = np_utils.to_categorical(valid_labels, nb_classes)            \n        test_labels = np_utils.to_categorical(test_labels, nb_classes)\n        \n        #image to float\n        train_images = train_images.astype('float32')            \n        valid_images = valid_images.astype('float32')\n        test_images = test_images.astype('float32')\n            \n        # normalize the value of RGB between 0-1\n        train_images /= 255\n        valid_images /= 255\n        test_images /= 255            \n        \n        self.train_images = train_images\n        self.valid_images = valid_images\n        self.test_images  = test_images\n        self.train_labels = train_labels\n        self.valid_labels = valid_labels\n        self.test_labels  = test_labels","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524446634520,"submitTime":1524446627306,"finishTime":1524446634677,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4ab05cde-59c3-435f-896c-ec5af2a1ebd3"},{"version":"CommandV1","origId":971216357823451,"guid":"1907b344-d257-4ced-8bf2-7a463f1aaf0d","subtype":"command","commandType":"auto","position":8.0,"command":"%md Next is load data from storage system. We have uploaded data source on DBFS (1062 jpg of Johnny Depp, 840 jpg of natalie portman), and read them here.\n\nAfter creating a new dataset object, including train_images, valid_images, test_images, train_labels, valid_labels, test_labels.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446627489,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"487af2a5-fd7b-41ab-95cc-ac3c8d3a826b"},{"version":"CommandV1","origId":971216357823452,"guid":"ff969d1a-ec34-403b-b836-8040db8a7fd2","subtype":"command","commandType":"auto","position":9.0,"command":"dataset = Dataset('/dbfs/FileStore/tables/data/')    \ndataset.load()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(1331, &apos;train samples&apos;)\n(571, &apos;valid samples&apos;)\n(951, &apos;test samples&apos;)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: global name &apos;img_channels&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-3011262163720556&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> dataset <span class=\"ansiyellow\">=</span> Dataset<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;/dbfs/FileStore/tables/testdata/&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>dataset<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;command-3011262163720554&gt;</span> in <span class=\"ansicyan\">load</span><span class=\"ansiblue\">(self, nb_classes)</span>\n<span class=\"ansigreen\">     29</span>         _<span class=\"ansiyellow\">,</span> test_images<span class=\"ansiyellow\">,</span> _<span class=\"ansiyellow\">,</span> test_labels <span class=\"ansiyellow\">=</span> train_test_split<span class=\"ansiyellow\">(</span>images<span class=\"ansiyellow\">,</span> labels<span class=\"ansiyellow\">,</span> test_size <span class=\"ansiyellow\">=</span> <span class=\"ansicyan\">0.5</span><span class=\"ansiyellow\">,</span> random_state <span class=\"ansiyellow\">=</span> random<span class=\"ansiyellow\">.</span>randint<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">100</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     30</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 31</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>input_shape <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">(</span>IMAGE_SIZE<span class=\"ansiyellow\">,</span> IMAGE_SIZE<span class=\"ansiyellow\">,</span> img_channels<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     32</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     33</span>         <span class=\"ansired\">#the amount of three data parts</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: global name &apos;img_channels&apos; is not defined</div>","workflows":[],"startTime":1524446634692,"submitTime":1524446627647,"finishTime":1524447030741,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a4cbc3b5-9e5f-4c25-b696-86fc840fc589"},{"version":"CommandV1","origId":971216357823453,"guid":"928560cd-39a2-474d-9ff8-c993a4d5f21d","subtype":"command","commandType":"auto","position":10.0,"command":"%md ##III. Build CNN model\nKeras provides plenty of API for building neural network model. We can build a sequential convolutional neural network easily. For more details you can read [Keras official document layers part](https://keras.io/layers/about-keras-layers/).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446627765,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8a0fc42d-1411-43ef-97a9-2d32bccac0af"},{"version":"CommandV1","origId":971216357823454,"guid":"095ff159-f8ef-4f21-95f1-330122b876b4","subtype":"command","commandType":"auto","position":10.25,"command":"def build_model(dataset, nb_classes = 2):\n    model = Sequential() \n\n    model.add(Conv2D(32, (3, 3), border_mode='same', \n                                 input_shape = dataset.input_shape))\n\n    model.add(Activation('relu'))\n    model.add(Conv2D(32, (3, 3)))\n    model.add(Activation('relu'))\n    model.add(MaxPooling2D(pool_size=(2, 2)))        \n    # droupout: present from Overfitting\n    model.add(Dropout(0.25))\n    model.add(Flatten())\n    model.add(Dense(256))\n    model.add(Activation('relu'))\n    model.add(Dropout(0.5))\n    model.add(Dense(nb_classes))\n    model.add(Activation('softmax'))\n    model.summary()\n    \n    return model","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;model&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-1885581869543657&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>model<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansigreen\">def</span> build_model<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">,</span> nb_classes <span class=\"ansiyellow\">=</span> <span class=\"ansicyan\">2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span>     model <span class=\"ansiyellow\">=</span> Sequential<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span>     model.add(Conv2D(32, (3, 3), border_mode=&apos;same&apos;, \n\n<span class=\"ansired\">NameError</span>: name &apos;model&apos; is not defined</div>","workflows":[],"startTime":1524447030749,"submitTime":1524446627885,"finishTime":1524447030814,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ff8d351e-7aaf-416e-9993-75ed8574bd52"},{"version":"CommandV1","origId":971216357823455,"guid":"81692f2c-7899-4ae1-9934-8ea0fe777621","subtype":"command","commandType":"auto","position":10.5,"command":"%md\nhere is an introduce of each kinds of layers in the CNN.\n\n###Convolution layer:\nThe emphasis here is on the function: Conv2D(). According to the Keras official document, 2D represents a 2D convolution, whose function is to perform sliding window convolution calculation on 2D input. Our facial image size is 64 x 64 pixels, which only contain length and width, so we are using a 2D convolution function to calculate the convolution. The sliding window calculation represents uses the convolution kernel to calculate pixels one by one in order.\n\n![conv2d img](https://raw.githubusercontent.com/JunxiFan/Big-Data-Systems-and-Intelligence-Analytics/master/image_portfolio/conv_layer.jpg)\n \nFirst, we will focus the convolution kernel on the first pixel of the image, here the pixel with a pixel value of 237. The area covered by the convolution kernel, and all pixels below it are averaged and then added together: \n\n_C(1) = 0 * 0.5 + 0 * 0.5 + 0 * 0.5 + 0 * 0.5 + 237 * 0.5 + 203 * 0.5 + 0 * 0.5 + 123 * 0.5 + 112 * 0.5_\n\nThen replace the first pixel in the image, then calculate the second, third…until we get a same size but convoluted image. As to the edge pixels, we fill over edge part with 0. We can use this setting in Conv2D() by code:\n\n_model.add(Conv2D(64, (3, 3), border_mode='same', input_shape = dataset.input_shape))_\n\nWe also need to tell Keras the data we input, which is 64*64 in RGB color, code: input_shape(64, 64, 3)\n\n###Activate function layer:\nRelu (Rectified Linear Units) function, the input is less than 0, the output is all 0, greater than 0 is equal to the input and output. The advantage of this function is its fast convergence. The keras library also supports several other activation functions: Softplus, Softsign, Tanh, Sigmoid, Hard_sigmoid, Linear. We tried all of this activation functions and decide to use Relu.\n\n###Max Pooling Layer:\nThe purpose of the pooling layer is to reduce the input feature map, simplify network computational complexity, and simultaneously compress features, highlighting key features.\n\n ![conv2d img](https://raw.githubusercontent.com/JunxiFan/Big-Data-Systems-and-Intelligence-Analytics/master/image_portfolio/MaxPooling_layer.jpg)\n \nWe establish the pooling layer by calling the MaxPooling2D() function. This function uses the maximum pooling method. This method selects the maximum value of the coverage area as the main feature of the area to compose a new reduced feature map. Thus, we will get a 32*32-pixel image after pooling.\n\n###Dropout Layer:\nThe Dropout layer randomly disconnects a certain percentage of input neuron links and consciously reduces the model parameters, making the model simple to prevent overfitting. Dropout() function use float parameter from 0-1 to define drop out percentage.\n\n###Flatten layer:\nAfter many times of convolution, pooling, and Dropout, here you can enter the full connection layer for final processing. The fully connected layer requires that the input data must be one-dimensional, so we must “squash” the input data into one dimension.\n\n###Dense layer:\nThe role here is for classification or regression, which is classification. We define dense layer through the Dense() function. One of the required parameters of this function is the number of neurons, which it is to specify how many outputs the layer has. In our code, the first dense layer specifies 512 neurons, that is, retains 512 features output to the next layer.\n\n###Classification layer: \nThe goal of the dense layer is to complete our classification requirements: 0 or 1.\nself.model.add(Dense(nb_classes))\nself.model.add(Activation('softmax'))\nIn the first row of code, we define classification requirement number of neurons, which is 2 for us. And in next layer, we use Softmax() to finish final classification. From the perspective of classification, the greater the output value of the neuron, the greater the likelihood that its corresponding category is a real category. Therefore, after the Softmax(), the upper N inputs are mapped to N probability distributions, and the sum of the probabilities is 1. The highest probability is the model predicted by the model.\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446628000,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7236ce43-6d69-4ff3-ab61-b5c08a9e297b"},{"version":"CommandV1","origId":971216357823456,"guid":"02600f3c-442e-48a9-a3b0-479f5dc20ae9","subtype":"command","commandType":"auto","position":10.625,"command":"%md Our structure of CNN model:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446628115,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc1f7972-db89-49d2-995c-ade8ad708f8e"},{"version":"CommandV1","origId":971216357823457,"guid":"f819065a-dffe-4fd9-8512-a5c6ef0f97bc","subtype":"command","commandType":"auto","position":10.78125,"command":"MODEL = build_model(dataset)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/tmp/1524445855144-0/PythonShell.py:5: UserWarning: Update your &#96;Conv2D&#96; call to the Keras 2 API: &#96;Conv2D(32, (3, 3), padding=&quot;same&quot;, input_shape=(64, 64, 3...)&#96;\n  import linecache\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nconv2d_1 (Conv2D)            (None, 64, 64, 32)        896       \n_________________________________________________________________\nactivation_1 (Activation)    (None, 64, 64, 32)        0         \n_________________________________________________________________\nconv2d_2 (Conv2D)            (None, 62, 62, 32)        9248      \n_________________________________________________________________\nactivation_2 (Activation)    (None, 62, 62, 32)        0         \n_________________________________________________________________\nmax_pooling2d_1 (MaxPooling2 (None, 31, 31, 32)        0         \n_________________________________________________________________\ndropout_1 (Dropout)          (None, 31, 31, 32)        0         \n_________________________________________________________________\nflatten_1 (Flatten)          (None, 30752)             0         \n_________________________________________________________________\ndense_1 (Dense)              (None, 256)               7872768   \n_________________________________________________________________\nactivation_3 (Activation)    (None, 256)               0         \n_________________________________________________________________\ndropout_2 (Dropout)          (None, 256)               0         \n_________________________________________________________________\ndense_2 (Dense)              (None, 2)                 514       \n_________________________________________________________________\nactivation_4 (Activation)    (None, 2)                 0         \n=================================================================\nTotal params: 7,883,426\nTrainable params: 7,883,426\nNon-trainable params: 0\n_________________________________________________________________\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524447030819,"submitTime":1524446628275,"finishTime":1524447031121,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cc6a53ac-082d-4c31-b981-f0914f42c39c"},{"version":"CommandV1","origId":971216357823458,"guid":"7d7d18f2-5059-478f-950f-b172f6b55b54","subtype":"command","commandType":"auto","position":10.8125,"command":"%md ##IV.\tTrainning\nNext is let the dataset we have prepared to train this model and do cross validations. We set the cost function as ‘categorical_crossentropy’, a typical function dealing with categorical project. The optimizer is SGD (Stochastic gradient descent optimizer), at the same time, Keras includes support for momentum, learning rate decay, and Nesterov momentum, which means we can take multiple advantages from them. Using SGD only, the decent direction depends on batch data completely, so add a momentum can keep original decent direction in some degree, make the optimizer works faster, but more stable. We set the epoch as 100, and at last we get a graph using spark DataFrame.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446628393,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8c793e49-00fd-4f9b-9621-379238f05bb5"},{"version":"CommandV1","origId":971216357823459,"guid":"9f60afcf-e7d6-4f64-a452-fc1b158e23df","subtype":"command","commandType":"auto","position":10.875,"command":"def train(dataset, model, batch_size = 40, nb_epoch = 100):\n    # SGD: a  compiler; lr: learning rate\n    sgd = SGD(lr = 0.001, decay = 1e-6, momentum = 0.9, nesterov = True) \n    \n    model.compile(loss='categorical_crossentropy',\n                  optimizer=sgd,\n                  metrics=['accuracy'])   \n\n    history = model.fit(dataset.train_images, dataset.train_labels,\n                   batch_size = batch_size,\n                   nb_epoch = nb_epoch,\n                   validation_data = (dataset.valid_images, dataset.valid_labels),\n                   shuffle = True)\n\n    res = history.history\n    return res","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524447031129,"submitTime":1524446628515,"finishTime":1524447031164,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b022b922-7a53-4982-b7cd-c03b15ab84db"},{"version":"CommandV1","origId":971216357823460,"guid":"06dbdd46-d83c-4346-9146-5eff92e4acbd","subtype":"command","commandType":"auto","position":10.9375,"command":"res = train(dataset, MODEL)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/databricks/python/local/lib/python2.7/site-packages/keras/models.py:942: UserWarning: The &#96;nb_epoch&#96; argument in &#96;fit&#96; has been renamed &#96;epochs&#96;.\n  warnings.warn(&apos;The &#96;nb_epoch&#96; argument in &#96;fit&#96; &apos;\nWARNING:tensorflow:Variable *= will be deprecated. Use variable.assign_mul if you want assignment to the variable value or &apos;x = x * y&apos; if you want a new python Tensor object.\nTrain on 1331 samples, validate on 571 samples\nEpoch 1/100\n\n  40/1331 [..............................] - ETA: 40s - loss: 0.7077 - acc: 0.4000\n  80/1331 [&gt;.............................] - ETA: 28s - loss: 0.7074 - acc: 0.4375\n 120/1331 [=&gt;............................] - ETA: 26s - loss: 0.7027 - acc: 0.4583\n 160/1331 [==&gt;...........................] - ETA: 25s - loss: 0.7055 - acc: 0.4312\n 200/1331 [===&gt;..........................] - ETA: 23s - loss: 0.7026 - acc: 0.4400\n 240/1331 [====&gt;.........................] - ETA: 23s - loss: 0.6984 - acc: 0.4667\n 280/1331 [=====&gt;........................] - ETA: 22s - loss: 0.6990 - acc: 0.4679\n 320/1331 [======&gt;.......................] - ETA: 21s - loss: 0.6993 - acc: 0.4688\n 360/1331 [=======&gt;......................] - ETA: 21s - loss: 0.6985 - acc: 0.4778\n 400/1331 [========&gt;.....................] - ETA: 19s - loss: 0.7006 - acc: 0.4775\n 440/1331 [========&gt;.....................] - ETA: 18s - loss: 0.7007 - acc: 0.4818\n 480/1331 [=========&gt;....................] - ETA: 17s - loss: 0.7015 - acc: 0.4854\n 520/1331 [==========&gt;...................] - ETA: 15s - loss: 0.7011 - acc: 0.4962\n 560/1331 [===========&gt;..................] - ETA: 14s - loss: 0.7005 - acc: 0.5071\n 600/1331 [============&gt;.................] - ETA: 14s - loss: 0.7000 - acc: 0.5083\n 640/1331 [=============&gt;................] - ETA: 13s - loss: 0.7010 - acc: 0.5094\n 680/1331 [==============&gt;...............] - ETA: 12s - loss: 0.6998 - acc: 0.5147\n 720/1331 [===============&gt;..............] - ETA: 11s - loss: 0.6975 - acc: 0.5167\n 760/1331 [================&gt;.............] - ETA: 10s - loss: 0.6951 - acc: 0.5263\n 800/1331 [=================&gt;............] - ETA: 9s - loss: 0.6948 - acc: 0.5287 \n 840/1331 [=================&gt;............] - ETA: 8s - loss: 0.6920 - acc: 0.5369\n 880/1331 [==================&gt;...........] - ETA: 7s - loss: 0.6925 - acc: 0.5341\n 920/1331 [===================&gt;..........] - ETA: 7s - loss: 0.6925 - acc: 0.5315\n 960/1331 [====================&gt;.........] - ETA: 6s - loss: 0.6950 - acc: 0.5302\n1000/1331 [=====================&gt;........] - ETA: 5s - loss: 0.6986 - acc: 0.5240\n1040/1331 [======================&gt;.......] - ETA: 4s - loss: 0.6980 - acc: 0.5260\n1080/1331 [=======================&gt;......] - ETA: 4s - loss: 0.6988 - acc: 0.5222\n1120/1331 [========================&gt;.....] - ETA: 3s - loss: 0.6991 - acc: 0.5196\n1160/1331 [=========================&gt;....] - ETA: 2s - loss: 0.6992 - acc: 0.5155\n1200/1331 [==========================&gt;...] - ETA: 2s - loss: 0.6993 - acc: 0.5142\n1240/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6985 - acc: 0.5177\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.6991 - acc: 0.5156\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.6992 - acc: 0.5144\n1331/1331 [==============================] - 24s 18ms/step - loss: 0.6991 - acc: 0.5147 - val_loss: 0.6857 - val_acc: 0.5744\nEpoch 2/100\n\n  40/1331 [..............................] - ETA: 22s - loss: 0.6922 - acc: 0.5500\n  80/1331 [&gt;.............................] - ETA: 20s - loss: 0.6931 - acc: 0.5250\n 120/1331 [=&gt;............................] - ETA: 20s - loss: 0.6945 - acc: 0.5083\n 160/1331 [==&gt;...........................] - ETA: 19s - loss: 0.6872 - acc: 0.5375\n 200/1331 [===&gt;..........................] - ETA: 18s - loss: 0.6840 - acc: 0.5650\n 240/1331 [====&gt;.........................] - ETA: 17s - loss: 0.6842 - acc: 0.5750\n 280/1331 [=====&gt;........................] - ETA: 16s - loss: 0.6863 - acc: 0.5536\n 320/1331 [======&gt;.......................] - ETA: 15s - loss: 0.6879 - acc: 0.5438\n 360/1331 [=======&gt;......................] - ETA: 14s - loss: 0.6894 - acc: 0.5417\n 400/1331 [========&gt;.....................] - ETA: 13s - loss: 0.6864 - acc: 0.5500\n 440/1331 [========&gt;.....................] - ETA: 12s - loss: 0.6884 - acc: 0.5364\n 480/1331 [=========&gt;....................] - ETA: 12s - loss: 0.6889 - acc: 0.5354\n 520/1331 [==========&gt;...................] - ETA: 11s - loss: 0.6889 - acc: 0.5385\n 560/1331 [===========&gt;..................] - ETA: 11s - loss: 0.6864 - acc: 0.5518\n 600/1331 [============&gt;.................] - ETA: 11s - loss: 0.6873 - acc: 0.5567\n 640/1331 [=============&gt;................] - ETA: 10s - loss: 0.6866 - acc: 0.5609\n 680/1331 [==============&gt;...............] - ETA: 9s - loss: 0.6866 - acc: 0.5618 \n 720/1331 [===============&gt;..............] - ETA: 9s - loss: 0.6867 - acc: 0.5583\n 760/1331 [================&gt;.............] - ETA: 8s - loss: 0.6864 - acc: 0.5618\n 800/1331 [=================&gt;............] - ETA: 8s - loss: 0.6859 - acc: 0.5638\n 840/1331 [=================&gt;............] - ETA: 7s - loss: 0.6874 - acc: 0.5607\n 880/1331 [==================&gt;...........] - ETA: 6s - loss: 0.6864 - acc: 0.5648\n 920/1331 [===================&gt;..........] - ETA: 6s - loss: 0.6854 - acc: 0.5674\n 960/1331 [====================&gt;.........] - ETA: 5s - loss: 0.6863 - acc: 0.5635\n1000/1331 [=====================&gt;........] - ETA: 4s - loss: 0.6876 - acc: 0.5580\n1040/1331 [======================&gt;.......] - ETA: 4s - loss: 0.6873 - acc: 0.5587\n1080/1331 [=======================&gt;......] - ETA: 3s - loss: 0.6866 - acc: 0.5611\n1120/1331 [========================&gt;.....] - ETA: 3s - loss: 0.6865 - acc: 0.5625\n1160/1331 [=========================&gt;....] - ETA: 2s - loss: 0.6873 - acc: 0.5578\n1200/1331 [==========================&gt;...] - ETA: 2s - loss: 0.6863 - acc: 0.5592\n1240/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6854 - acc: 0.5621\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.6844 - acc: 0.5648\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.6847 - acc: 0.5644\n1331/1331 [==============================] - 23s 17ms/step - loss: 0.6846 - acc: 0.5642 - val_loss: 0.6666 - val_acc: 0.6445\nEpoch 3/100\n\n  40/1331 [..............................] - ETA: 28s - loss: 0.6412 - acc: 0.6750\n  80/1331 [&gt;.............................] - ETA: 27s - loss: 0.6476 - acc: 0.6500\n 120/1331 [=&gt;............................] - ETA: 26s - loss: 0.6511 - acc: 0.6583\n 160/1331 [==&gt;...........................] - ETA: 25s - loss: 0.6504 - acc: 0.6562\n 200/1331 [===&gt;..........................] - ETA: 24s - loss: 0.6542 - acc: 0.6650\n 240/1331 [====&gt;.........................] - ETA: 21s - loss: 0.6538 - acc: 0.6708\n 280/1331 [=====&gt;........................] - ETA: 19s - loss: 0.6585 - acc: 0.6393\n 320/1331 [======&gt;.......................] - ETA: 18s - loss: 0.6549 - acc: 0.6437\n 360/1331 [=======&gt;......................] - ETA: 17s - loss: 0.6588 - acc: 0.6361\n 400/1331 [========&gt;.....................] - ETA: 16s - loss: 0.6610 - acc: 0.6300\n 440/1331 [========&gt;.....................] - ETA: 15s - loss: 0.6650 - acc: 0.6227\n 480/1331 [=========&gt;....................] - ETA: 15s - loss: 0.6677 - acc: 0.6146\n 520/1331 [==========&gt;...................] - ETA: 14s - loss: 0.6678 - acc: 0.6115\n 560/1331 [===========&gt;..................] - ETA: 14s - loss: 0.6695 - acc: 0.6000\n 600/1331 [============&gt;.................] - ETA: 13s - loss: 0.6695 - acc: 0.5950\n 640/1331 [=============&gt;................] - ETA: 12s - loss: 0.6697 - acc: 0.5969\n 680/1331 [==============&gt;...............] - ETA: 11s - loss: 0.6715 - acc: 0.5897\n 720/1331 [===============&gt;..............] - ETA: 10s - loss: 0.6706 - acc: 0.5917\n 760/1331 [================&gt;.............] - ETA: 10s - loss: 0.6706 - acc: 0.5921\n 800/1331 [=================&gt;............] - ETA: 9s - loss: 0.6697 - acc: 0.5962 \n 840/1331 [=================&gt;............] - ETA: 8s - loss: 0.6698 - acc: 0.5929\n 880/1331 [==================&gt;...........] - ETA: 8s - loss: 0.6695 - acc: 0.5966\n 920/1331 [===================&gt;..........] - ETA: 7s - loss: 0.6675 - acc: 0.6000\n 960/1331 [====================&gt;.........] - ETA: 6s - loss: 0.6664 - acc: 0.6062\n1000/1331 [=====================&gt;........] - ETA: 6s - loss: 0.6668 - acc: 0.6060\n1040/1331 [======================&gt;.......] - ETA: 5s - loss: 0.6682 - acc: 0.6019\n1080/1331 [=======================&gt;......] - ETA: 4s - loss: 0.6679 - acc: 0.6065\n1120/1331 [========================&gt;.....] - ETA: 3s - loss: 0.6672 - acc: 0.6107\n1160/1331 [=========================&gt;....] - ETA: 3s - loss: 0.6657 - acc: 0.6147\n1200/1331 [==========================&gt;...] - ETA: 2s - loss: 0.6657 - acc: 0.6150\n1240/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6661 - acc: 0.6153\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.6657 - acc: 0.6172\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.6653 - acc: 0.6174\n1331/1331 [==============================] - 27s 20ms/step - loss: 0.6654 - acc: 0.6176 - val_loss: 0.6542 - val_acc: 0.6708\nEpoch 4/100\n\n  40/1331 [..............................] - ETA: 21s - loss: 0.6512 - acc: 0.6500\n  80/1331 [&gt;.............................] - ETA: 19s - loss: 0.6590 - acc: 0.6125\n 120/1331 [=&gt;............................] - ETA: 20s - loss: 0.6556 - acc: 0.6333\n 160/1331 [==&gt;...........................] - ETA: 21s - loss: 0.6502 - acc: 0.6437\n 200/1331 [===&gt;..........................] - ETA: 18s - loss: 0.6606 - acc: 0.6250\n 240/1331 [====&gt;.........................] - ETA: 18s - loss: 0.6661 - acc: 0.6083\n 280/1331 [=====&gt;........................] - ETA: 17s - loss: 0.6611 - acc: 0.6214\n 320/1331 [======&gt;.......................] - ETA: 18s - loss: 0.6651 - acc: 0.6125\n 360/1331 [=======&gt;......................] - ETA: 17s - loss: 0.6634 - acc: 0.6167\n 400/1331 [========&gt;.....................] - ETA: 17s - loss: 0.6614 - acc: 0.6250\n 440/1331 [========&gt;.....................] - ETA: 16s - loss: 0.6606 - acc: 0.6295\n 480/1331 [=========&gt;....................] - ETA: 15s - loss: 0.6578 - acc: 0.6354\n 520/1331 [==========&gt;...................] - ETA: 15s - loss: 0.6574 - acc: 0.6385\n 560/1331 [===========&gt;..................] - ETA: 14s - loss: 0.6575 - acc: 0.6357\n 600/1331 [============&gt;.................] - ETA: 13s - loss: 0.6575 - acc: 0.6350\n 640/1331 [=============&gt;................] - ETA: 13s - loss: 0.6571 - acc: 0.6375\n 680/1331 [==============&gt;...............] - ETA: 12s - loss: 0.6568 - acc: 0.6412\n 720/1331 [===============&gt;..............] - ETA: 11s - loss: 0.6562 - acc: 0.6417\n 760/1331 [================&gt;.............] - ETA: 10s - loss: 0.6570 - acc: 0.6447\n 800/1331 [=================&gt;............] - ETA: 9s - loss: 0.6557 - acc: 0.6462 \n 840/1331 [=================&gt;............] - ETA: 8s - loss: 0.6556 - acc: 0.6476\n 880/1331 [==================&gt;...........] - ETA: 8s - loss: 0.6554 - acc: 0.6455\n 920/1331 [===================&gt;..........] - ETA: 7s - loss: 0.6537 - acc: 0.6467\n 960/1331 [====================&gt;.........] - ETA: 6s - loss: 0.6540 - acc: 0.6448\n1000/1331 [=====================&gt;........] - ETA: 6s - loss: 0.6531 - acc: 0.6450\n1040/1331 [======================&gt;.......] - ETA: 5s - loss: 0.6535 - acc: 0.6423\n1080/1331 [=======================&gt;......] - ETA: 4s - loss: 0.6524 - acc: 0.6444\n1120/1331 [========================&gt;.....] - ETA: 3s - loss: 0.6515 - acc: 0.6446\n1160/1331 [=========================&gt;....] - ETA: 3s - loss: 0.6519 - acc: 0.6431\n1200/1331 [==========================&gt;...] - ETA: 2s - loss: 0.6504 - acc: 0.6483\n1240/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6498 - acc: 0.6500\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.6503 - acc: 0.6469\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.6499 - acc: 0.6439\n1331/1331 [==============================] - 25s 19ms/step - loss: 0.6498 - acc: 0.6439 - val_loss: 0.6390 - val_acc: 0.6620\nEpoch 5/100\n\n  40/1331 [..............................] - ETA: 19s - loss: 0.6377 - acc: 0.5250\n  80/1331 [&gt;.............................] - ETA: 20s - loss: 0.6447 - acc: 0.5875\n 120/1331 [=&gt;............................] - ETA: 19s - loss: 0.6354 - acc: 0.6250\n 160/1331 [==&gt;...........................] - ETA: 16s - loss: 0.6473 - acc: 0.6375\n 200/1331 [===&gt;..........................] - ETA: 16s - loss: 0.6531 - acc: 0.6350\n 240/1331 [====&gt;.........................] - ETA: 16s - loss: 0.6420 - acc: 0.6500\n 280/1331 [=====&gt;........................] - ETA: 16s - loss: 0.6384 - acc: 0.6536\n 320/1331 [======&gt;.......................] - ETA: 15s - loss: 0.6463 - acc: 0.6344\n 360/1331 [=======&gt;......................] - ETA: 15s - loss: 0.6447 - acc: 0.6361\n 400/1331 [========&gt;.....................] - ETA: 14s - loss: 0.6446 - acc: 0.6375\n 440/1331 [========&gt;.....................] - ETA: 13s - loss: 0.6438 - acc: 0.6386\n 480/1331 [=========&gt;....................] - ETA: 13s - loss: 0.6443 - acc: 0.6354\n 520/1331 [==========&gt;...................] - ETA: 12s - loss: 0.6481 - acc: 0.6327\n 560/1331 [===========&gt;..................] - ETA: 11s - loss: 0.6473 - acc: 0.6286\n 600/1331 [============&gt;.................] - ETA: 11s - loss: 0.6435 - acc: 0.6350\n 640/1331 [=============&gt;................] - ETA: 10s - loss: 0.6443 - acc: 0.6359\n 680/1331 [==============&gt;...............] - ETA: 9s - loss: 0.6443 - acc: 0.6412 \n 720/1331 [===============&gt;..............] - ETA: 9s - loss: 0.6442 - acc: 0.6431\n 760/1331 [================&gt;.............] - ETA: 8s - loss: 0.6419 - acc: 0.6421\n 800/1331 [=================&gt;............] - ETA: 8s - loss: 0.6447 - acc: 0.6375\n 840/1331 [=================&gt;............] - ETA: 7s - loss: 0.6435 - acc: 0.6417\n 880/1331 [==================&gt;...........] - ETA: 6s - loss: 0.6421 - acc: 0.6466\n 920/1331 [===================&gt;..........] - ETA: 6s - loss: 0.6462 - acc: 0.6391\n 960/1331 [====================&gt;.........] - ETA: 5s - loss: 0.6455 - acc: 0.6365\n1000/1331 [=====================&gt;........] - ETA: 5s - loss: 0.6451 - acc: 0.6380\n1040/1331 [======================&gt;.......] - ETA: 4s - loss: 0.6441 - acc: 0.6385\n1080/1331 [=======================&gt;......] - ETA: 3s - loss: 0.6426 - acc: 0.6417\n1120/1331 [========================&gt;.....] - ETA: 3s - loss: 0.6409 - acc: 0.6411\n1160/1331 [=========================&gt;....] - ETA: 2s - loss: 0.6415 - acc: 0.6414\n1200/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6414 - acc: 0.6400\n1240/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6400 - acc: 0.6435\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.6392 - acc: 0.6461\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.6390 - acc: 0.6462\n1331/1331 [==============================] - 22s 16ms/step - loss: 0.6385 - acc: 0.6484 - val_loss: 0.6211 - val_acc: 0.6813\nEpoch 6/100\n\n  40/1331 [..............................] - ETA: 17s - loss: 0.6171 - acc: 0.5750\n  80/1331 [&gt;.............................] - ETA: 17s - loss: 0.6166 - acc: 0.6625\n 120/1331 [=&gt;............................] - ETA: 15s - loss: 0.6122 - acc: 0.6833\n 160/1331 [==&gt;...........................] - ETA: 14s - loss: 0.6116 - acc: 0.6750\n 200/1331 [===&gt;..........................] - ETA: 15s - loss: 0.6241 - acc: 0.6750\n 240/1331 [====&gt;.........................] - ETA: 14s - loss: 0.6191 - acc: 0.6833\n 280/1331 [=====&gt;........................] - ETA: 14s - loss: 0.6243 - acc: 0.6679\n 320/1331 [======&gt;.......................] - ETA: 13s - loss: 0.6187 - acc: 0.6750\n 360/1331 [=======&gt;......................] - ETA: 13s - loss: 0.6158 - acc: 0.6750\n 400/1331 [========&gt;.....................] - ETA: 12s - loss: 0.6176 - acc: 0.6750\n 440/1331 [========&gt;.....................] - ETA: 12s - loss: 0.6257 - acc: 0.6659\n 480/1331 [=========&gt;....................] - ETA: 11s - loss: 0.6249 - acc: 0.6667\n 520/1331 [==========&gt;...................] - ETA: 11s - loss: 0.6261 - acc: 0.6673\n 560/1331 [===========&gt;..................] - ETA: 10s - loss: 0.6198 - acc: 0.6750\n 600/1331 [============&gt;.................] - ETA: 10s - loss: 0.6230 - acc: 0.6650\n 640/1331 [=============&gt;................] - ETA: 9s - loss: 0.6186 - acc: 0.6734 \n 680/1331 [==============&gt;...............] - ETA: 9s - loss: 0.6207 - acc: 0.6706\n 720/1331 [===============&gt;..............] - ETA: 8s - loss: 0.6212 - acc: 0.6708\n 760/1331 [================&gt;.............] - ETA: 8s - loss: 0.6219 - acc: 0.6697\n 800/1331 [=================&gt;............] - ETA: 7s - loss: 0.6241 - acc: 0.6675\n 840/1331 [=================&gt;............] - ETA: 7s - loss: 0.6272 - acc: 0.6595\n 880/1331 [==================&gt;...........] - ETA: 6s - loss: 0.6243 - acc: 0.6659\n 920/1331 [===================&gt;..........] - ETA: 5s - loss: 0.6242 - acc: 0.6696\n 960/1331 [====================&gt;.........] - ETA: 5s - loss: 0.6239 - acc: 0.6677\n1000/1331 [=====================&gt;........] - ETA: 4s - loss: 0.6233 - acc: 0.6660\n1040/1331 [======================&gt;.......] - ETA: 4s - loss: 0.6215 - acc: 0.6673\n1080/1331 [=======================&gt;......] - ETA: 3s - loss: 0.6207 - acc: 0.6667\n1120/1331 [========================&gt;.....] - ETA: 2s - loss: 0.6219 - acc: 0.6625\n1160/1331 [=========================&gt;....] - ETA: 2s - loss: 0.6189 - acc: 0.6655\n1200/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6167 - acc: 0.6700\n1240/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6176 - acc: 0.6710\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.6182 - acc: 0.6688\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.6185 - acc: 0.6682\n1331/1331 [==============================] - 21s 16ms/step - loss: 0.6183 - acc: 0.6687 - val_loss: 0.6037 - val_acc: 0.7040\nEpoch 7/100\n\n  40/1331 [..............................] - ETA: 17s - loss: 0.6585 - acc: 0.6000\n  80/1331 [&gt;.............................] - ETA: 18s - loss: 0.6461 - acc: 0.6375\n 120/1331 [=&gt;............................] - ETA: 16s - loss: 0.6341 - acc: 0.6250\n 160/1331 [==&gt;...........................] - ETA: 16s - loss: 0.6241 - acc: 0.6438\n 200/1331 [===&gt;..........................] - ETA: 14s - loss: 0.6326 - acc: 0.6400\n 240/1331 [====&gt;.........................] - ETA: 14s - loss: 0.6412 - acc: 0.6333\n 280/1331 [=====&gt;........................] - ETA: 14s - loss: 0.6314 - acc: 0.6464\n 320/1331 [======&gt;.......................] - ETA: 14s - loss: 0.6337 - acc: 0.6375\n 360/1331 [=======&gt;......................] - ETA: 14s - loss: 0.6337 - acc: 0.6389\n 400/1331 [========&gt;.....................] - ETA: 13s - loss: 0.6322 - acc: 0.6425\n 440/1331 [========&gt;.....................] - ETA: 12s - loss: 0.6217 - acc: 0.6523\n 480/1331 [=========&gt;....................] - ETA: 11s - loss: 0.6294 - acc: 0.6417\n 520/1331 [==========&gt;...................] - ETA: 10s - loss: 0.6242 - acc: 0.6462\n 560/1331 [===========&gt;..................] - ETA: 10s - loss: 0.6222 - acc: 0.6518\n 600/1331 [============&gt;.................] - ETA: 10s - loss: 0.6263 - acc: 0.6517\n 640/1331 [=============&gt;................] - ETA: 9s - loss: 0.6224 - acc: 0.6594 \n 680/1331 [==============&gt;...............] - ETA: 8s - loss: 0.6191 - acc: 0.6603\n 720/1331 [===============&gt;..............] - ETA: 8s - loss: 0.6167 - acc: 0.6639\n 760/1331 [================&gt;.............] - ETA: 7s - loss: 0.6144 - acc: 0.6658\n 800/1331 [=================&gt;............] - ETA: 7s - loss: 0.6127 - acc: 0.6688\n 840/1331 [=================&gt;............] - ETA: 6s - loss: 0.6127 - acc: 0.6690\n 880/1331 [==================&gt;...........] - ETA: 6s - loss: 0.6123 - acc: 0.6670\n 920/1331 [===================&gt;..........] - ETA: 5s - loss: 0.6088 - acc: 0.6717\n 960/1331 [====================&gt;.........] - ETA: 5s - loss: 0.6066 - acc: 0.6750\n1000/1331 [=====================&gt;........] - ETA: 4s - loss: 0.6081 - acc: 0.6730\n1040/1331 [======================&gt;.......] - ETA: 4s - loss: 0.6069 - acc: 0.6740\n1080/1331 [=======================&gt;......] - ETA: 3s - loss: 0.6045 - acc: 0.6778\n1120/1331 [========================&gt;.....] - ETA: 2s - loss: 0.6053 - acc: 0.6750\n1160/1331 [=========================&gt;....] - ETA: 2s - loss: 0.6043 - acc: 0.6759\n1200/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6047 - acc: 0.6750\n1240/1331 [==========================&gt;...] - ETA: 1s - loss: 0.6048 - acc: 0.6742\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.6036 - acc: 0.6766\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.6037 - acc: 0.6765\n1331/1331 [==============================] - 21s 16ms/step - loss: 0.6048 - acc: 0.6747 - val_loss: 0.6071 - val_acc: 0.6848\nEpoch 8/100\n\n  40/1331 [..............................] - ETA: 23s - loss: 0.6562 - acc: 0.6000\n  80/1331 [&gt;.............................] - ETA: 21s - loss: 0.6115 - acc: 0.6875\n 120/1331 [=&gt;............................] - ETA: 20s - loss: 0.6063 - acc: 0.6833\n 160/1331 [==&gt;...........................] - ETA: 17s - loss: 0.5911 - acc: 0.7000\n 200/1331 [===&gt;..........................] - ETA: 16s - loss: 0.6004 - acc: 0.6900\n 240/1331 [====&gt;.........................] - ETA: 16s - loss: 0.6172 - acc: 0.6708\n 280/1331 [=====&gt;........................] - ETA: 16s - loss: 0.6185 - acc: 0.6714\n 320/1331 [======&gt;.......................] - ETA: 15s - loss: 0.6146 - acc: 0.6875\n 360/1331 [=======&gt;......................] - ETA: 15s - loss: 0.6102 - acc: 0.6889\n 400/1331 [========&gt;.....................] - ETA: 14s - loss: 0.6007 - acc: 0.6975\n 440/1331 [========&gt;.....................] - ETA: 13s - loss: 0.5954 - acc: 0.7023\n 480/1331 [=========&gt;....................] - ETA: 12s - loss: 0.6037 - acc: 0.6896\n 520/1331 [==========&gt;...................] - ETA: 12s - loss: 0.6029 - acc: 0.6865\n 560/1331 [===========&gt;..................] - ETA: 11s - loss: 0.6062 - acc: 0.6875\n 600/1331 [============&gt;.................] - ETA: 11s - loss: 0.6069 - acc: 0.6850\n 640/1331 [=============&gt;................] - ETA: 10s - loss: 0.6062 - acc: 0.6859\n 680/1331 [==============&gt;...............] - ETA: 9s - loss: 0.6131 - acc: 0.6779 \n 720/1331 [===============&gt;..............] - ETA: 9s - loss: 0.6109 - acc: 0.6806\n 760/1331 [================&gt;.............] - ETA: 8s - loss: 0.6145 - acc: 0.6750\n 800/1331 [=================&gt;............] - ETA: 8s - loss: 0.6073 - acc: 0.6875\n 840/1331 [=================&gt;............] - ETA: 7s - loss: 0.6052 - acc: 0.6893\n 880/1331 [==================&gt;...........] - ETA: 6s - loss: 0.6042 - acc: 0.6886\n 920/1331 [===================&gt;..........] - ETA: 6s - loss: 0.6001 - acc: 0.6924\n 960/1331 [====================&gt;.........] - ETA: 5s - loss: 0.5967 - acc: 0.6958\n1000/1331 [=====================&gt;........] - ETA: 5s - loss: 0.5975 - acc: 0.6970\n1040/1331 [======================&gt;.......] - ETA: 4s - loss: 0.5973 - acc: 0.6962\n1080/1331 [=======================&gt;......] - ETA: 3s - loss: 0.5984 - acc: 0.6963\n1120/1331 [========================&gt;.....] - ETA: 3s - loss: 0.5964 - acc: 0.6973\n1160/1331 [=========================&gt;....] - ETA: 2s - loss: 0.5972 - acc: 0.6948\n1200/1331 [==========================&gt;...] - ETA: 1s - loss: 0.5978 - acc: 0.6950\n1240/1331 [==========================&gt;...] - ETA: 1s - loss: 0.5959 - acc: 0.6935\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.5985 - acc: 0.6898\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.5981 - acc: 0.6894\n1331/1331 [==============================] - 23s 17ms/step - loss: 0.5971 - acc: 0.6912 - val_loss: 0.6029 - val_acc: 0.6690\nEpoch 9/100\n\n  40/1331 [..............................] - ETA: 22s - loss: 0.5674 - acc: 0.7250\n  80/1331 [&gt;.............................] - ETA: 22s - loss: 0.5399 - acc: 0.7375\n 120/1331 [=&gt;............................] - ETA: 20s - loss: 0.5793 - acc: 0.7000\n 160/1331 [==&gt;...........................] - ETA: 17s - loss: 0.6008 - acc: 0.6688\n 200/1331 [===&gt;..........................] - ETA: 16s - loss: 0.6018 - acc: 0.6800\n 240/1331 [====&gt;.........................] - ETA: 15s - loss: 0.6021 - acc: 0.6750\n 280/1331 [=====&gt;........................] - ETA: 14s - loss: 0.5959 - acc: 0.6893\n 320/1331 [======&gt;.......................] - ETA: 14s - loss: 0.5942 - acc: 0.6812\n 360/1331 [=======&gt;......................] - ETA: 14s - loss: 0.5893 - acc: 0.6917\n 400/1331 [========&gt;.....................] - ETA: 13s - loss: 0.5980 - acc: 0.6875\n 440/1331 [========&gt;.....................] - ETA: 13s - loss: 0.5966 - acc: 0.6841\n 480/1331 [=========&gt;....................] - ETA: 12s - loss: 0.5937 - acc: 0.6875\n 520/1331 [==========&gt;...................] - ETA: 11s - loss: 0.5939 - acc: 0.6865\n 560/1331 [===========&gt;..................] - ETA: 10s - loss: 0.5930 - acc: 0.6893\n 600/1331 [============&gt;.................] - ETA: 10s - loss: 0.5903 - acc: 0.6933\n 640/1331 [=============&gt;................] - ETA: 9s - loss: 0.5857 - acc: 0.6984 \n 680/1331 [==============&gt;...............] - ETA: 9s - loss: 0.5842 - acc: 0.6985\n 720/1331 [===============&gt;..............] - ETA: 8s - loss: 0.5839 - acc: 0.6972\n 760/1331 [================&gt;.............] - ETA: 8s - loss: 0.5840 - acc: 0.6987\n 800/1331 [=================&gt;............] - ETA: 7s - loss: 0.5838 - acc: 0.7000\n 840/1331 [=================&gt;............] - ETA: 7s - loss: 0.5838 - acc: 0.6988\n\n*** WARNING: skipped 236115 bytes of output ***\n\n 360/1331 [=======&gt;......................] - ETA: 6s - loss: 0.0304 - acc: 0.9944\n 400/1331 [========&gt;.....................] - ETA: 6s - loss: 0.0316 - acc: 0.9925\n 440/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0336 - acc: 0.9909\n 480/1331 [=========&gt;....................] - ETA: 5s - loss: 0.0325 - acc: 0.9917\n 520/1331 [==========&gt;...................] - ETA: 5s - loss: 0.0314 - acc: 0.9923\n 560/1331 [===========&gt;..................] - ETA: 4s - loss: 0.0319 - acc: 0.9911\n 600/1331 [============&gt;.................] - ETA: 4s - loss: 0.0313 - acc: 0.9917\n 640/1331 [=============&gt;................] - ETA: 4s - loss: 0.0304 - acc: 0.9922\n 680/1331 [==============&gt;...............] - ETA: 4s - loss: 0.0299 - acc: 0.9926\n 720/1331 [===============&gt;..............] - ETA: 3s - loss: 0.0295 - acc: 0.9931\n 760/1331 [================&gt;.............] - ETA: 3s - loss: 0.0290 - acc: 0.9934\n 800/1331 [=================&gt;............] - ETA: 3s - loss: 0.0281 - acc: 0.9938\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0276 - acc: 0.9940\n 880/1331 [==================&gt;...........] - ETA: 2s - loss: 0.0273 - acc: 0.9943\n 920/1331 [===================&gt;..........] - ETA: 2s - loss: 0.0282 - acc: 0.9935\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0293 - acc: 0.9927\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0287 - acc: 0.9930\n1040/1331 [======================&gt;.......] - ETA: 1s - loss: 0.0288 - acc: 0.9933\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0280 - acc: 0.9935\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0283 - acc: 0.9938\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0282 - acc: 0.9940\n1200/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0290 - acc: 0.9933\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0290 - acc: 0.9935\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0286 - acc: 0.9938\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0284 - acc: 0.9939\n1331/1331 [==============================] - 10s 7ms/step - loss: 0.0283 - acc: 0.9940 - val_loss: 1.0260 - val_acc: 0.7163\nEpoch 93/100\n\n  40/1331 [..............................] - ETA: 8s - loss: 0.0236 - acc: 1.0000\n  80/1331 [&gt;.............................] - ETA: 7s - loss: 0.0170 - acc: 1.0000\n 120/1331 [=&gt;............................] - ETA: 7s - loss: 0.0142 - acc: 1.0000\n 160/1331 [==&gt;...........................] - ETA: 7s - loss: 0.0232 - acc: 0.9938\n 200/1331 [===&gt;..........................] - ETA: 7s - loss: 0.0228 - acc: 0.9950\n 240/1331 [====&gt;.........................] - ETA: 6s - loss: 0.0201 - acc: 0.9958\n 280/1331 [=====&gt;........................] - ETA: 6s - loss: 0.0207 - acc: 0.9964\n 320/1331 [======&gt;.......................] - ETA: 6s - loss: 0.0201 - acc: 0.9969\n 360/1331 [=======&gt;......................] - ETA: 6s - loss: 0.0194 - acc: 0.9972\n 400/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0210 - acc: 0.9975\n 440/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0208 - acc: 0.9977\n 480/1331 [=========&gt;....................] - ETA: 5s - loss: 0.0244 - acc: 0.9938\n 520/1331 [==========&gt;...................] - ETA: 5s - loss: 0.0250 - acc: 0.9923\n 560/1331 [===========&gt;..................] - ETA: 4s - loss: 0.0250 - acc: 0.9929\n 600/1331 [============&gt;.................] - ETA: 4s - loss: 0.0248 - acc: 0.9933\n 640/1331 [=============&gt;................] - ETA: 4s - loss: 0.0243 - acc: 0.9938\n 680/1331 [==============&gt;...............] - ETA: 4s - loss: 0.0238 - acc: 0.9941\n 720/1331 [===============&gt;..............] - ETA: 3s - loss: 0.0251 - acc: 0.9931\n 760/1331 [================&gt;.............] - ETA: 3s - loss: 0.0244 - acc: 0.9934\n 800/1331 [=================&gt;............] - ETA: 3s - loss: 0.0244 - acc: 0.9938\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0237 - acc: 0.9940\n 880/1331 [==================&gt;...........] - ETA: 2s - loss: 0.0232 - acc: 0.9943\n 920/1331 [===================&gt;..........] - ETA: 2s - loss: 0.0251 - acc: 0.9935\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0259 - acc: 0.9938\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0261 - acc: 0.9940\n1040/1331 [======================&gt;.......] - ETA: 1s - loss: 0.0258 - acc: 0.9942\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0252 - acc: 0.9944\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0251 - acc: 0.9946\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0252 - acc: 0.9948\n1200/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0259 - acc: 0.9942\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0256 - acc: 0.9944\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0259 - acc: 0.9938\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0257 - acc: 0.9939\n1331/1331 [==============================] - 9s 7ms/step - loss: 0.0256 - acc: 0.9940 - val_loss: 1.0467 - val_acc: 0.7128\nEpoch 94/100\n\n  40/1331 [..............................] - ETA: 7s - loss: 0.0532 - acc: 0.9500\n  80/1331 [&gt;.............................] - ETA: 7s - loss: 0.0397 - acc: 0.9750\n 120/1331 [=&gt;............................] - ETA: 7s - loss: 0.0313 - acc: 0.9833\n 160/1331 [==&gt;...........................] - ETA: 7s - loss: 0.0287 - acc: 0.9875\n 200/1331 [===&gt;..........................] - ETA: 7s - loss: 0.0280 - acc: 0.9900\n 240/1331 [====&gt;.........................] - ETA: 6s - loss: 0.0307 - acc: 0.9875\n 280/1331 [=====&gt;........................] - ETA: 6s - loss: 0.0284 - acc: 0.9893\n 320/1331 [======&gt;.......................] - ETA: 6s - loss: 0.0303 - acc: 0.9875\n 360/1331 [=======&gt;......................] - ETA: 6s - loss: 0.0280 - acc: 0.9889\n 400/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0267 - acc: 0.9900\n 440/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0253 - acc: 0.9909\n 480/1331 [=========&gt;....................] - ETA: 5s - loss: 0.0259 - acc: 0.9917\n 520/1331 [==========&gt;...................] - ETA: 5s - loss: 0.0247 - acc: 0.9923\n 560/1331 [===========&gt;..................] - ETA: 4s - loss: 0.0240 - acc: 0.9929\n 600/1331 [============&gt;.................] - ETA: 4s - loss: 0.0260 - acc: 0.9917\n 640/1331 [=============&gt;................] - ETA: 4s - loss: 0.0257 - acc: 0.9922\n 680/1331 [==============&gt;...............] - ETA: 4s - loss: 0.0252 - acc: 0.9926\n 720/1331 [===============&gt;..............] - ETA: 3s - loss: 0.0246 - acc: 0.9931\n 760/1331 [================&gt;.............] - ETA: 3s - loss: 0.0241 - acc: 0.9934\n 800/1331 [=================&gt;............] - ETA: 3s - loss: 0.0241 - acc: 0.9938\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0241 - acc: 0.9940\n 880/1331 [==================&gt;...........] - ETA: 2s - loss: 0.0246 - acc: 0.9932\n 920/1331 [===================&gt;..........] - ETA: 2s - loss: 0.0242 - acc: 0.9935\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0239 - acc: 0.9938\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0254 - acc: 0.9930\n1040/1331 [======================&gt;.......] - ETA: 1s - loss: 0.0258 - acc: 0.9933\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0265 - acc: 0.9926\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0270 - acc: 0.9920\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0268 - acc: 0.9922\n1200/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0272 - acc: 0.9925\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0269 - acc: 0.9927\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0267 - acc: 0.9930\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0265 - acc: 0.9932\n1331/1331 [==============================] - 10s 8ms/step - loss: 0.0264 - acc: 0.9932 - val_loss: 1.0593 - val_acc: 0.7145\nEpoch 95/100\n\n  40/1331 [..............................] - ETA: 9s - loss: 0.0311 - acc: 1.0000\n  80/1331 [&gt;.............................] - ETA: 8s - loss: 0.0284 - acc: 1.0000\n 120/1331 [=&gt;............................] - ETA: 8s - loss: 0.0237 - acc: 1.0000\n 160/1331 [==&gt;...........................] - ETA: 8s - loss: 0.0222 - acc: 1.0000\n 200/1331 [===&gt;..........................] - ETA: 8s - loss: 0.0236 - acc: 1.0000\n 240/1331 [====&gt;.........................] - ETA: 8s - loss: 0.0219 - acc: 1.0000\n 280/1331 [=====&gt;........................] - ETA: 7s - loss: 0.0201 - acc: 1.0000\n 320/1331 [======&gt;.......................] - ETA: 7s - loss: 0.0185 - acc: 1.0000\n 360/1331 [=======&gt;......................] - ETA: 7s - loss: 0.0194 - acc: 1.0000\n 400/1331 [========&gt;.....................] - ETA: 7s - loss: 0.0189 - acc: 1.0000\n 440/1331 [========&gt;.....................] - ETA: 6s - loss: 0.0197 - acc: 1.0000\n 480/1331 [=========&gt;....................] - ETA: 6s - loss: 0.0190 - acc: 1.0000\n 520/1331 [==========&gt;...................] - ETA: 6s - loss: 0.0193 - acc: 1.0000\n 560/1331 [===========&gt;..................] - ETA: 5s - loss: 0.0201 - acc: 0.9982\n 600/1331 [============&gt;.................] - ETA: 5s - loss: 0.0214 - acc: 0.9983\n 640/1331 [=============&gt;................] - ETA: 5s - loss: 0.0234 - acc: 0.9984\n 680/1331 [==============&gt;...............] - ETA: 4s - loss: 0.0231 - acc: 0.9985\n 720/1331 [===============&gt;..............] - ETA: 4s - loss: 0.0228 - acc: 0.9986\n 760/1331 [================&gt;.............] - ETA: 4s - loss: 0.0241 - acc: 0.9987\n 800/1331 [=================&gt;............] - ETA: 4s - loss: 0.0232 - acc: 0.9988\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0227 - acc: 0.9988\n 880/1331 [==================&gt;...........] - ETA: 3s - loss: 0.0231 - acc: 0.9989\n 920/1331 [===================&gt;..........] - ETA: 3s - loss: 0.0231 - acc: 0.9989\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0242 - acc: 0.9979\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0238 - acc: 0.9980\n1040/1331 [======================&gt;.......] - ETA: 2s - loss: 0.0234 - acc: 0.9981\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0239 - acc: 0.9981\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0245 - acc: 0.9982\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0256 - acc: 0.9974\n1200/1331 [==========================&gt;...] - ETA: 1s - loss: 0.0252 - acc: 0.9975\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0254 - acc: 0.9976\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0255 - acc: 0.9977\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0253 - acc: 0.9977\n1331/1331 [==============================] - 11s 8ms/step - loss: 0.0252 - acc: 0.9977 - val_loss: 1.0446 - val_acc: 0.7163\nEpoch 96/100\n\n  40/1331 [..............................] - ETA: 9s - loss: 0.0174 - acc: 1.0000\n  80/1331 [&gt;.............................] - ETA: 8s - loss: 0.0139 - acc: 1.0000\n 120/1331 [=&gt;............................] - ETA: 8s - loss: 0.0120 - acc: 1.0000\n 160/1331 [==&gt;...........................] - ETA: 8s - loss: 0.0159 - acc: 1.0000\n 200/1331 [===&gt;..........................] - ETA: 7s - loss: 0.0170 - acc: 1.0000\n 240/1331 [====&gt;.........................] - ETA: 7s - loss: 0.0196 - acc: 0.9958\n 280/1331 [=====&gt;........................] - ETA: 7s - loss: 0.0207 - acc: 0.9964\n 320/1331 [======&gt;.......................] - ETA: 7s - loss: 0.0223 - acc: 0.9969\n 360/1331 [=======&gt;......................] - ETA: 6s - loss: 0.0209 - acc: 0.9972\n 400/1331 [========&gt;.....................] - ETA: 6s - loss: 0.0203 - acc: 0.9975\n 440/1331 [========&gt;.....................] - ETA: 6s - loss: 0.0205 - acc: 0.9977\n 480/1331 [=========&gt;....................] - ETA: 5s - loss: 0.0204 - acc: 0.9979\n 520/1331 [==========&gt;...................] - ETA: 5s - loss: 0.0210 - acc: 0.9981\n 560/1331 [===========&gt;..................] - ETA: 5s - loss: 0.0212 - acc: 0.9982\n 600/1331 [============&gt;.................] - ETA: 5s - loss: 0.0227 - acc: 0.9967\n 640/1331 [=============&gt;................] - ETA: 4s - loss: 0.0237 - acc: 0.9969\n 680/1331 [==============&gt;...............] - ETA: 4s - loss: 0.0249 - acc: 0.9956\n 720/1331 [===============&gt;..............] - ETA: 4s - loss: 0.0243 - acc: 0.9958\n 760/1331 [================&gt;.............] - ETA: 4s - loss: 0.0263 - acc: 0.9947\n 800/1331 [=================&gt;............] - ETA: 3s - loss: 0.0253 - acc: 0.9950\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0250 - acc: 0.9952\n 880/1331 [==================&gt;...........] - ETA: 3s - loss: 0.0246 - acc: 0.9955\n 920/1331 [===================&gt;..........] - ETA: 3s - loss: 0.0247 - acc: 0.9957\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0249 - acc: 0.9948\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0242 - acc: 0.9950\n1040/1331 [======================&gt;.......] - ETA: 2s - loss: 0.0239 - acc: 0.9952\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0239 - acc: 0.9954\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0242 - acc: 0.9946\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0238 - acc: 0.9948\n1200/1331 [==========================&gt;...] - ETA: 1s - loss: 0.0235 - acc: 0.9950\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0233 - acc: 0.9952\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0230 - acc: 0.9953\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0232 - acc: 0.9955\n1331/1331 [==============================] - 12s 9ms/step - loss: 0.0230 - acc: 0.9955 - val_loss: 1.0417 - val_acc: 0.7285\nEpoch 97/100\n\n  40/1331 [..............................] - ETA: 10s - loss: 0.0631 - acc: 0.9750\n  80/1331 [&gt;.............................] - ETA: 9s - loss: 0.0399 - acc: 0.9875 \n 120/1331 [=&gt;............................] - ETA: 10s - loss: 0.0364 - acc: 0.9917\n 160/1331 [==&gt;...........................] - ETA: 10s - loss: 0.0324 - acc: 0.9938\n 200/1331 [===&gt;..........................] - ETA: 9s - loss: 0.0311 - acc: 0.9950 \n 240/1331 [====&gt;.........................] - ETA: 8s - loss: 0.0280 - acc: 0.9958\n 280/1331 [=====&gt;........................] - ETA: 8s - loss: 0.0262 - acc: 0.9964\n 320/1331 [======&gt;.......................] - ETA: 8s - loss: 0.0259 - acc: 0.9969\n 360/1331 [=======&gt;......................] - ETA: 7s - loss: 0.0247 - acc: 0.9972\n 400/1331 [========&gt;.....................] - ETA: 7s - loss: 0.0253 - acc: 0.9975\n 440/1331 [========&gt;.....................] - ETA: 6s - loss: 0.0237 - acc: 0.9977\n 480/1331 [=========&gt;....................] - ETA: 6s - loss: 0.0247 - acc: 0.9979\n 520/1331 [==========&gt;...................] - ETA: 6s - loss: 0.0245 - acc: 0.9981\n 560/1331 [===========&gt;..................] - ETA: 5s - loss: 0.0254 - acc: 0.9964\n 600/1331 [============&gt;.................] - ETA: 5s - loss: 0.0251 - acc: 0.9967\n 640/1331 [=============&gt;................] - ETA: 5s - loss: 0.0254 - acc: 0.9969\n 680/1331 [==============&gt;...............] - ETA: 5s - loss: 0.0250 - acc: 0.9971\n 720/1331 [===============&gt;..............] - ETA: 4s - loss: 0.0242 - acc: 0.9972\n 760/1331 [================&gt;.............] - ETA: 4s - loss: 0.0252 - acc: 0.9974\n 800/1331 [=================&gt;............] - ETA: 4s - loss: 0.0252 - acc: 0.9975\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0252 - acc: 0.9976\n 880/1331 [==================&gt;...........] - ETA: 3s - loss: 0.0260 - acc: 0.9966\n 920/1331 [===================&gt;..........] - ETA: 3s - loss: 0.0252 - acc: 0.9967\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0267 - acc: 0.9958\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0268 - acc: 0.9950\n1040/1331 [======================&gt;.......] - ETA: 2s - loss: 0.0266 - acc: 0.9952\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0262 - acc: 0.9954\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0261 - acc: 0.9955\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0258 - acc: 0.9957\n1200/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0254 - acc: 0.9958\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0252 - acc: 0.9960\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0248 - acc: 0.9961\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0248 - acc: 0.9962\n1331/1331 [==============================] - 11s 9ms/step - loss: 0.0246 - acc: 0.9962 - val_loss: 1.0908 - val_acc: 0.7180\nEpoch 98/100\n\n  40/1331 [..............................] - ETA: 10s - loss: 0.0088 - acc: 1.0000\n  80/1331 [&gt;.............................] - ETA: 9s - loss: 0.0281 - acc: 0.9875 \n 120/1331 [=&gt;............................] - ETA: 9s - loss: 0.0283 - acc: 0.9917\n 160/1331 [==&gt;...........................] - ETA: 8s - loss: 0.0320 - acc: 0.9875\n 200/1331 [===&gt;..........................] - ETA: 8s - loss: 0.0399 - acc: 0.9800\n 240/1331 [====&gt;.........................] - ETA: 8s - loss: 0.0347 - acc: 0.9833\n 280/1331 [=====&gt;........................] - ETA: 8s - loss: 0.0321 - acc: 0.9857\n 320/1331 [======&gt;.......................] - ETA: 7s - loss: 0.0311 - acc: 0.9875\n 360/1331 [=======&gt;......................] - ETA: 7s - loss: 0.0299 - acc: 0.9889\n 400/1331 [========&gt;.....................] - ETA: 7s - loss: 0.0307 - acc: 0.9875\n 440/1331 [========&gt;.....................] - ETA: 6s - loss: 0.0296 - acc: 0.9886\n 480/1331 [=========&gt;....................] - ETA: 6s - loss: 0.0288 - acc: 0.9896\n 520/1331 [==========&gt;...................] - ETA: 5s - loss: 0.0275 - acc: 0.9904\n 560/1331 [===========&gt;..................] - ETA: 5s - loss: 0.0272 - acc: 0.9911\n 600/1331 [============&gt;.................] - ETA: 5s - loss: 0.0276 - acc: 0.9917\n 640/1331 [=============&gt;................] - ETA: 4s - loss: 0.0274 - acc: 0.9922\n 680/1331 [==============&gt;...............] - ETA: 4s - loss: 0.0274 - acc: 0.9926\n 720/1331 [===============&gt;..............] - ETA: 4s - loss: 0.0269 - acc: 0.9931\n 760/1331 [================&gt;.............] - ETA: 3s - loss: 0.0264 - acc: 0.9934\n 800/1331 [=================&gt;............] - ETA: 3s - loss: 0.0263 - acc: 0.9938\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0260 - acc: 0.9940\n 880/1331 [==================&gt;...........] - ETA: 3s - loss: 0.0264 - acc: 0.9943\n 920/1331 [===================&gt;..........] - ETA: 2s - loss: 0.0260 - acc: 0.9946\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0266 - acc: 0.9938\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0265 - acc: 0.9940\n1040/1331 [======================&gt;.......] - ETA: 1s - loss: 0.0260 - acc: 0.9942\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0285 - acc: 0.9935\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0288 - acc: 0.9929\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0293 - acc: 0.9922\n1200/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0289 - acc: 0.9925\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0296 - acc: 0.9919\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0299 - acc: 0.9922\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0300 - acc: 0.9917\n1331/1331 [==============================] - 10s 7ms/step - loss: 0.0307 - acc: 0.9910 - val_loss: 1.0244 - val_acc: 0.7163\nEpoch 99/100\n\n  40/1331 [..............................] - ETA: 8s - loss: 0.0076 - acc: 1.0000\n  80/1331 [&gt;.............................] - ETA: 8s - loss: 0.0112 - acc: 1.0000\n 120/1331 [=&gt;............................] - ETA: 7s - loss: 0.0105 - acc: 1.0000\n 160/1331 [==&gt;...........................] - ETA: 7s - loss: 0.0102 - acc: 1.0000\n 200/1331 [===&gt;..........................] - ETA: 7s - loss: 0.0144 - acc: 1.0000\n 240/1331 [====&gt;.........................] - ETA: 7s - loss: 0.0149 - acc: 1.0000\n 280/1331 [=====&gt;........................] - ETA: 6s - loss: 0.0187 - acc: 1.0000\n 320/1331 [======&gt;.......................] - ETA: 6s - loss: 0.0201 - acc: 1.0000\n 360/1331 [=======&gt;......................] - ETA: 6s - loss: 0.0208 - acc: 1.0000\n 400/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0245 - acc: 0.9975\n 440/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0250 - acc: 0.9977\n 480/1331 [=========&gt;....................] - ETA: 5s - loss: 0.0261 - acc: 0.9958\n 520/1331 [==========&gt;...................] - ETA: 5s - loss: 0.0258 - acc: 0.9962\n 560/1331 [===========&gt;..................] - ETA: 4s - loss: 0.0248 - acc: 0.9964\n 600/1331 [============&gt;.................] - ETA: 4s - loss: 0.0247 - acc: 0.9967\n 640/1331 [=============&gt;................] - ETA: 4s - loss: 0.0266 - acc: 0.9953\n 680/1331 [==============&gt;...............] - ETA: 4s - loss: 0.0258 - acc: 0.9956\n 720/1331 [===============&gt;..............] - ETA: 3s - loss: 0.0251 - acc: 0.9958\n 760/1331 [================&gt;.............] - ETA: 3s - loss: 0.0245 - acc: 0.9961\n 800/1331 [=================&gt;............] - ETA: 3s - loss: 0.0239 - acc: 0.9963\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0245 - acc: 0.9964\n 880/1331 [==================&gt;...........] - ETA: 2s - loss: 0.0261 - acc: 0.9955\n 920/1331 [===================&gt;..........] - ETA: 2s - loss: 0.0262 - acc: 0.9957\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0260 - acc: 0.9958\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0261 - acc: 0.9960\n1040/1331 [======================&gt;.......] - ETA: 1s - loss: 0.0259 - acc: 0.9962\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0254 - acc: 0.9963\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0251 - acc: 0.9964\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0250 - acc: 0.9966\n1200/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0247 - acc: 0.9967\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0243 - acc: 0.9968\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0238 - acc: 0.9969\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0251 - acc: 0.9962\n1331/1331 [==============================] - 9s 7ms/step - loss: 0.0249 - acc: 0.9962 - val_loss: 1.1068 - val_acc: 0.7180\nEpoch 100/100\n\n  40/1331 [..............................] - ETA: 8s - loss: 0.0644 - acc: 0.9750\n  80/1331 [&gt;.............................] - ETA: 7s - loss: 0.0442 - acc: 0.9875\n 120/1331 [=&gt;............................] - ETA: 7s - loss: 0.0355 - acc: 0.9917\n 160/1331 [==&gt;...........................] - ETA: 7s - loss: 0.0308 - acc: 0.9938\n 200/1331 [===&gt;..........................] - ETA: 7s - loss: 0.0279 - acc: 0.9950\n 240/1331 [====&gt;.........................] - ETA: 6s - loss: 0.0268 - acc: 0.9958\n 280/1331 [=====&gt;........................] - ETA: 6s - loss: 0.0245 - acc: 0.9964\n 320/1331 [======&gt;.......................] - ETA: 6s - loss: 0.0242 - acc: 0.9969\n 360/1331 [=======&gt;......................] - ETA: 6s - loss: 0.0346 - acc: 0.9917\n 400/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0391 - acc: 0.9900\n 440/1331 [========&gt;.....................] - ETA: 5s - loss: 0.0372 - acc: 0.9909\n 480/1331 [=========&gt;....................] - ETA: 5s - loss: 0.0355 - acc: 0.9917\n 520/1331 [==========&gt;...................] - ETA: 5s - loss: 0.0333 - acc: 0.9923\n 560/1331 [===========&gt;..................] - ETA: 4s - loss: 0.0329 - acc: 0.9929\n 600/1331 [============&gt;.................] - ETA: 4s - loss: 0.0321 - acc: 0.9933\n 640/1331 [=============&gt;................] - ETA: 4s - loss: 0.0322 - acc: 0.9938\n 680/1331 [==============&gt;...............] - ETA: 4s - loss: 0.0332 - acc: 0.9926\n 720/1331 [===============&gt;..............] - ETA: 3s - loss: 0.0321 - acc: 0.9931\n 760/1331 [================&gt;.............] - ETA: 3s - loss: 0.0318 - acc: 0.9934\n 800/1331 [=================&gt;............] - ETA: 3s - loss: 0.0318 - acc: 0.9938\n 840/1331 [=================&gt;............] - ETA: 3s - loss: 0.0319 - acc: 0.9940\n 880/1331 [==================&gt;...........] - ETA: 2s - loss: 0.0317 - acc: 0.9943\n 920/1331 [===================&gt;..........] - ETA: 2s - loss: 0.0308 - acc: 0.9946\n 960/1331 [====================&gt;.........] - ETA: 2s - loss: 0.0304 - acc: 0.9948\n1000/1331 [=====================&gt;........] - ETA: 2s - loss: 0.0311 - acc: 0.9940\n1040/1331 [======================&gt;.......] - ETA: 1s - loss: 0.0312 - acc: 0.9942\n1080/1331 [=======================&gt;......] - ETA: 1s - loss: 0.0307 - acc: 0.9944\n1120/1331 [========================&gt;.....] - ETA: 1s - loss: 0.0300 - acc: 0.9946\n1160/1331 [=========================&gt;....] - ETA: 1s - loss: 0.0296 - acc: 0.9948\n1200/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0293 - acc: 0.9950\n1240/1331 [==========================&gt;...] - ETA: 0s - loss: 0.0289 - acc: 0.9952\n1280/1331 [===========================&gt;..] - ETA: 0s - loss: 0.0286 - acc: 0.9953\n1320/1331 [============================&gt;.] - ETA: 0s - loss: 0.0282 - acc: 0.9955\n1331/1331 [==============================] - 9s 7ms/step - loss: 0.0280 - acc: 0.9955 - val_loss: 1.0478 - val_acc: 0.7128\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1524447031174,"submitTime":1524446628631,"finishTime":1524448941099,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"480ce327-510c-4ad7-9294-85ea0274125c"},{"version":"CommandV1","origId":971216357823461,"guid":"b237ecfa-7237-4b94-95f9-330c4045c32f","subtype":"command","commandType":"auto","position":10.96875,"command":"i=1\ntemp_epoch = []\n\nfor each in range(len(res['acc'])):\n#   print(i)\n  temp_epoch.append(i)\n  i+=1\nres['epoch'] = temp_epoch\n\ndf = pd.DataFrame(res)\nspark_df = spark.createDataFrame(df)\ndisplay(spark_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.5146506340946138,1,0.6991007478500469,0.5744308309463194,0.6856619511093233],[0.5642374156114305,2,0.6845547137271185,0.6444833629394371,0.6666393892777571],[0.6175807671471703,3,0.6654200890653569,0.6707530684521236,0.6541698387124284],[0.6438767842830885,4,0.6497677505061109,0.6619964947633693,0.6390098286384877],[0.6483846739393531,5,0.6384781019567637,0.6812609456048956,0.6211324296565481],[0.6686701733397864,6,0.6182649403385073,0.7040280242517408,0.6037242388558263],[0.6746806909633166,7,0.6048021653287846,0.6847635764374207,0.6071020487937326],[0.6912096152620867,8,0.5970899778635854,0.6690017575766702,0.6028677843080511],[0.6897069874067758,9,0.5820217804296137,0.6847635680865072,0.5905214523058222],[0.717505633607115,10,0.5666948849325517,0.6584938718642119,0.6233327160157172],[0.7092411703045972,11,0.5678639912811282,0.6777583177995765,0.6022105099023328],[0.7107438055489137,12,0.5653204914325167,0.7075306425578958,0.5700004900921456],[0.7220135225020881,13,0.5445856854577068,0.705779336066672,0.5695450404583886],[0.7227648375716808,14,0.5420924161807833,0.7250437732335774,0.5577911404719912],[0.7370398174005733,15,0.5354276190432814,0.7215411537791718,0.5593103150561478],[0.7422990213651391,16,0.5221807737488392,0.7145359023439906,0.5630193497274469],[0.7475582279270525,17,0.5259652874865629,0.7145359023439906,0.5611265206712767],[0.7565740032987788,18,0.5092958102407176,0.7092819638719909,0.5764221470744305],[0.7573253128154218,19,0.503785799290344,0.7302977253801978,0.5601831829589636],[0.759579262233694,20,0.4976299195518895,0.7197898389370345,0.549586840769873],[0.769346359660982,21,0.4793760075459885,0.705779339093878,0.5939787636183189],[0.7753568754260652,22,0.47508693448947303,0.7285464093898099,0.546978095471337],[0.788129227399647,23,0.4697408625991787,0.730297721204741,0.5422387760386993],[0.7933884297520661,24,0.45444891396364173,0.7215411579546286,0.5545754252611651],[0.7918857992994077,25,0.4455839922157649,0.7320490341679228,0.5499575745620995],[0.7866265956483148,26,0.4527921223667311,0.7390542928057668,0.5408186990304502],[0.8219383903502702,27,0.40299344370680407,0.7092819596965342,0.6085629109847775],[0.8144252436399281,28,0.41742277987284554,0.7127845905290594,0.5689799856074846],[0.820435761375413,29,0.40839115405423043,0.7250437827327414,0.5438060535023383],[0.8339594261347127,30,0.3853053457749508,0.7373029696127161,0.5511516059655859],[0.8347107436225255,31,0.3804401073081434,0.7215411632783358,0.5548743948523093],[0.8407212621640837,32,0.3817678219747221,0.7285464135652666,0.5507613877698961],[0.8392186313979524,33,0.3624123449302275,0.7302977230836966,0.5583596532795767],[0.8437265238754736,34,0.3514885686108441,0.7267950975748787,0.5513466777191897],[0.8625093948832139,35,0.32515680658960594,0.7320490455460423,0.5743701926150381],[0.8632607003247084,36,0.33274937524641485,0.7390542969812236,0.5571471027338358],[0.8790383177713557,37,0.3015148795631754,0.7075306437061464,0.5975537322552943],[0.8797896313631471,38,0.29258995617940675,0.7320490330196722,0.5901148903286394],[0.8955672450481188,39,0.2882459437506795,0.7285464093898099,0.5844295760274142],[0.8782869996118151,40,0.2909211750813304,0.707530647881603,0.6009125837407053],[0.896318554564762,41,0.2660737176034614,0.716287219482629,0.5961822354334249],[0.8985725049682348,42,0.2622219979382385,0.7302977181775349,0.5897463476073304],[0.9113448520605946,43,0.24735861424437866,0.7215411537791718,0.6084744046636305],[0.9188580054434325,44,0.23215040018198457,0.7215411579546286,0.6045296320564484],[0.9256198339942342,45,0.22927506526639638,0.7232924697695596,0.6067186168634745],[0.9233658917410583,46,0.21332624592698668,0.7302977170292843,0.6083423157602601],[0.9286250952130238,47,0.20386899762544122,0.7232924697695596,0.634870893953143],[0.933884297878916,48,0.19454300653253795,0.7197898389370345,0.6357428080250628],[0.9398948190178216,49,0.18371298837536354,0.7145359016132856,0.6549524370509145],[0.9406461348934876,50,0.18654398923525678,0.7145358981685338,0.6664009288918951],[0.9444027040167736,51,0.1722374749667299,0.7250437850292426,0.6763829213620902],[0.9504132292308277,52,0.15839954994613295,0.7162872134282168,0.711102306842804],[0.9429000717728412,53,0.15894439489567397,0.7267950933994219,0.6692055653252242],[0.9616829530356255,54,0.1339203305458503,0.7110332715114653,0.7110299748317999],[0.9624342635374693,55,0.13307843285113863,0.719789837058079,0.6984017773705898],[0.9534184886583433,56,0.13939064312908186,0.7110332756869221,0.6997723798096285],[0.9684447869602493,57,0.11880396803033522,0.7092819638719909,0.7428059668236147],[0.968444778003879,58,0.11718828002428937,0.7197898431124913,0.7402810155301504],[0.9699474169203073,59,0.11392503226725881,0.716287209983465,0.747778927016801],[0.9654395306226815,60,0.11640687176858366,0.7162872111317156,0.7684005005660283],[0.9759579313867169,61,0.1042582556146325,0.7197898461396974,0.7762244914229405],[0.9752066226761472,62,0.09818566987566667,0.7215411621300852,0.748911534737789],[0.9842223970626728,63,0.08183164743442091,0.7197898389370345,0.8041175382045439],[0.9752066119285028,64,0.09212925172586534,0.7250437774090341,0.8306362333001273],[0.9827197653113408,65,0.08360359179322026,0.7145359076676978,0.7884086273910703],[0.9827197653113408,66,0.07747038632385002,0.7320490383433794,0.8039854511279358],[0.9819684494356747,67,0.07876111907222547,0.7267951017503355,0.8306532482862891],[0.9812171353512827,68,0.0754894971830741,0.7302977253801978,0.8270055574418784],[0.9864763411071227,69,0.06913174633118642,0.7215411537791718,0.8227593964014704],[0.9834710860682286,70,0.0665552373961521,0.73380034901006,0.8695094548883455],[0.9879789710671807,71,0.0628518666232398,0.7092819585482836,0.8627580186635935],[0.9789631913068328,72,0.07407237324026811,0.7285464093898099,0.8207595569657361],[0.9887302851515726,73,0.06161906961477582,0.7302977295556544,0.8919084178065252],[0.9872276534002405,74,0.058568464302416585,0.7127845905290594,0.875135570607962],[0.9857250252314567,75,0.06321379290732738,0.7267950933994219,0.8760788863991271],[0.9917355414891404,76,0.05507354906625111,0.7180385271221034,0.9074985624507931],[0.9917355432804145,77,0.05114532946689428,0.7110332715114653,0.8990805205447034],[0.9887302851515726,78,0.04957110292168375,0.7197898377887839,0.8893040257869794],[0.9909842274047485,79,0.042332228698580894,0.7057793349184214,0.917629910590561],[0.9939894850409899,80,0.03698691625531503,0.7197898347615778,0.9517150845920141],[0.9902329133203566,81,0.0475109598550744,0.7197898419642407,0.9433516171579812],[0.9947408014092564,82,0.039136149168328,0.7215411579546286,0.9591721422096059],[0.9954921154936484,83,0.03591285390565263,0.7145358951413276,0.9496655156754362],[0.9917355432804145,84,0.038171906048007964,0.7092819555210775,0.9498430474835812],[0.9969947436624322,85,0.03686989266159479,0.7110332673360087,0.9570633652122551],[0.9939894819510422,86,0.034156400251330335,0.7075306353552329,0.9534567191596625],[0.9947408014092564,87,0.03410343523959438,0.714535903492241,0.9414592117018958],[0.9962434295780402,88,0.02801466240057096,0.7180385210676912,0.9851968747199938],[0.9932381732404725,89,0.030869491841255006,0.7145358909658709,1.042699944012637],[0.9932381714491983,90,0.028945202289175756,0.7162872111317156,1.0014374088593831],[0.9924868573648065,91,0.030767647648869734,0.7092819596965342,1.0007524145881266],[0.9939894873248644,92,0.028273654933025253,0.716287219482629,1.0260147845369296],[0.9939894855335903,93,0.025578068420962673,0.7127845875018533,1.0467111026760576],[0.9932381714491983,94,0.026351075141552827,0.7145358993167844,1.0592694585774283],[0.9977460577468241,95,0.025187737066340705,0.7162872069562588,1.0446311690552639],[0.9954921154936484,96,0.023049686880744463,0.7285464105380605,1.0417278311924842],[0.9962434295780402,97,0.024604233930616518,0.71803851877119,1.0908220127459791],[0.9909842287034222,98,0.030658910746506333,0.7162872069562588,1.0243997884924065],[0.9962434295780402,99,0.024941285366820807,0.7180385294186046,1.1067909366090745],[0.9954921137023742,100,0.027981076859760607,0.7127845821781459,1.047821370398727]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"acc","type":"\"double\"","metadata":"{}"},{"name":"epoch","type":"\"long\"","metadata":"{}"},{"name":"loss","type":"\"double\"","metadata":"{}"},{"name":"val_acc","type":"\"double\"","metadata":"{}"},{"name":"val_loss","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"spark_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"acc","nullable":true,"type":"double"},{"metadata":{},"name":"epoch","nullable":true,"type":"long"},{"metadata":{},"name":"loss","nullable":true,"type":"double"},{"metadata":{},"name":"val_acc","nullable":true,"type":"double"},{"metadata":{},"name":"val_loss","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{}},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;temp_optimizer&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-1885581869543667&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      6</span>   i<span class=\"ansiyellow\">+=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> res<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;epoch&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> temp_epoch<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 8</span><span class=\"ansiyellow\"> </span>res<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;optimizer&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> temp_optimizer<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     10</span> df_adam <span class=\"ansiyellow\">=</span> pd<span class=\"ansiyellow\">.</span>DataFrame<span class=\"ansiyellow\">(</span>res<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;temp_optimizer&apos; is not defined</div>","workflows":[],"startTime":1524448941110,"submitTime":1524446628748,"finishTime":1524448943193,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"mgLine","width":"848.011364","height":"611.011364","xColumns":["epoch"],"yColumns":["acc","val_acc"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":true}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"mgLine":[{"key":"param","value":"{\"right\":60,\"bottom\":50,\"area\":false,\"missing_is_hidden\":true,\"animate_on_load\":false,\"transition_on_update\":false,\"colors\":[\"#1f77b4\",\"#ff7f0e\",\"#2ca02c\",\"#d62728\",\"#9467bd\",\"#8c564b\",\"#e377c2\",\"#7f7f7f\",\"#bcbd22\",\"#17becf\",\"#aec7e8\",\"#ffbb78\",\"#98df8a\",\"#ff9896\",\"#c5b0d5\",\"#c49c94\",\"#f7b6d2\",\"#c7c7c7\",\"#dbdb8d\",\"#9edae5\"],\"x_label\":\"epoch\",\"legend\":[\"acc\",\"val_acc\"]}"}],"mapPlot":[],"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"boxPlot":[],"lineChart":[],"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":0.3}],"qqPlot":[],"quantilePlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9e9c3725-cebf-41cf-aa30-d1b3daad03b7"},{"version":"CommandV1","origId":971216357823462,"guid":"c53cf3d7-87f8-4930-b4eb-a2c6944ddb38","subtype":"command","commandType":"auto","position":10.984375,"command":"display(spark_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.5146506340946138,1,0.6991007478500469,0.5744308309463194,0.6856619511093233],[0.5642374156114305,2,0.6845547137271185,0.6444833629394371,0.6666393892777571],[0.6175807671471703,3,0.6654200890653569,0.6707530684521236,0.6541698387124284],[0.6438767842830885,4,0.6497677505061109,0.6619964947633693,0.6390098286384877],[0.6483846739393531,5,0.6384781019567637,0.6812609456048956,0.6211324296565481],[0.6686701733397864,6,0.6182649403385073,0.7040280242517408,0.6037242388558263],[0.6746806909633166,7,0.6048021653287846,0.6847635764374207,0.6071020487937326],[0.6912096152620867,8,0.5970899778635854,0.6690017575766702,0.6028677843080511],[0.6897069874067758,9,0.5820217804296137,0.6847635680865072,0.5905214523058222],[0.717505633607115,10,0.5666948849325517,0.6584938718642119,0.6233327160157172],[0.7092411703045972,11,0.5678639912811282,0.6777583177995765,0.6022105099023328],[0.7107438055489137,12,0.5653204914325167,0.7075306425578958,0.5700004900921456],[0.7220135225020881,13,0.5445856854577068,0.705779336066672,0.5695450404583886],[0.7227648375716808,14,0.5420924161807833,0.7250437732335774,0.5577911404719912],[0.7370398174005733,15,0.5354276190432814,0.7215411537791718,0.5593103150561478],[0.7422990213651391,16,0.5221807737488392,0.7145359023439906,0.5630193497274469],[0.7475582279270525,17,0.5259652874865629,0.7145359023439906,0.5611265206712767],[0.7565740032987788,18,0.5092958102407176,0.7092819638719909,0.5764221470744305],[0.7573253128154218,19,0.503785799290344,0.7302977253801978,0.5601831829589636],[0.759579262233694,20,0.4976299195518895,0.7197898389370345,0.549586840769873],[0.769346359660982,21,0.4793760075459885,0.705779339093878,0.5939787636183189],[0.7753568754260652,22,0.47508693448947303,0.7285464093898099,0.546978095471337],[0.788129227399647,23,0.4697408625991787,0.730297721204741,0.5422387760386993],[0.7933884297520661,24,0.45444891396364173,0.7215411579546286,0.5545754252611651],[0.7918857992994077,25,0.4455839922157649,0.7320490341679228,0.5499575745620995],[0.7866265956483148,26,0.4527921223667311,0.7390542928057668,0.5408186990304502],[0.8219383903502702,27,0.40299344370680407,0.7092819596965342,0.6085629109847775],[0.8144252436399281,28,0.41742277987284554,0.7127845905290594,0.5689799856074846],[0.820435761375413,29,0.40839115405423043,0.7250437827327414,0.5438060535023383],[0.8339594261347127,30,0.3853053457749508,0.7373029696127161,0.5511516059655859],[0.8347107436225255,31,0.3804401073081434,0.7215411632783358,0.5548743948523093],[0.8407212621640837,32,0.3817678219747221,0.7285464135652666,0.5507613877698961],[0.8392186313979524,33,0.3624123449302275,0.7302977230836966,0.5583596532795767],[0.8437265238754736,34,0.3514885686108441,0.7267950975748787,0.5513466777191897],[0.8625093948832139,35,0.32515680658960594,0.7320490455460423,0.5743701926150381],[0.8632607003247084,36,0.33274937524641485,0.7390542969812236,0.5571471027338358],[0.8790383177713557,37,0.3015148795631754,0.7075306437061464,0.5975537322552943],[0.8797896313631471,38,0.29258995617940675,0.7320490330196722,0.5901148903286394],[0.8955672450481188,39,0.2882459437506795,0.7285464093898099,0.5844295760274142],[0.8782869996118151,40,0.2909211750813304,0.707530647881603,0.6009125837407053],[0.896318554564762,41,0.2660737176034614,0.716287219482629,0.5961822354334249],[0.8985725049682348,42,0.2622219979382385,0.7302977181775349,0.5897463476073304],[0.9113448520605946,43,0.24735861424437866,0.7215411537791718,0.6084744046636305],[0.9188580054434325,44,0.23215040018198457,0.7215411579546286,0.6045296320564484],[0.9256198339942342,45,0.22927506526639638,0.7232924697695596,0.6067186168634745],[0.9233658917410583,46,0.21332624592698668,0.7302977170292843,0.6083423157602601],[0.9286250952130238,47,0.20386899762544122,0.7232924697695596,0.634870893953143],[0.933884297878916,48,0.19454300653253795,0.7197898389370345,0.6357428080250628],[0.9398948190178216,49,0.18371298837536354,0.7145359016132856,0.6549524370509145],[0.9406461348934876,50,0.18654398923525678,0.7145358981685338,0.6664009288918951],[0.9444027040167736,51,0.1722374749667299,0.7250437850292426,0.6763829213620902],[0.9504132292308277,52,0.15839954994613295,0.7162872134282168,0.711102306842804],[0.9429000717728412,53,0.15894439489567397,0.7267950933994219,0.6692055653252242],[0.9616829530356255,54,0.1339203305458503,0.7110332715114653,0.7110299748317999],[0.9624342635374693,55,0.13307843285113863,0.719789837058079,0.6984017773705898],[0.9534184886583433,56,0.13939064312908186,0.7110332756869221,0.6997723798096285],[0.9684447869602493,57,0.11880396803033522,0.7092819638719909,0.7428059668236147],[0.968444778003879,58,0.11718828002428937,0.7197898431124913,0.7402810155301504],[0.9699474169203073,59,0.11392503226725881,0.716287209983465,0.747778927016801],[0.9654395306226815,60,0.11640687176858366,0.7162872111317156,0.7684005005660283],[0.9759579313867169,61,0.1042582556146325,0.7197898461396974,0.7762244914229405],[0.9752066226761472,62,0.09818566987566667,0.7215411621300852,0.748911534737789],[0.9842223970626728,63,0.08183164743442091,0.7197898389370345,0.8041175382045439],[0.9752066119285028,64,0.09212925172586534,0.7250437774090341,0.8306362333001273],[0.9827197653113408,65,0.08360359179322026,0.7145359076676978,0.7884086273910703],[0.9827197653113408,66,0.07747038632385002,0.7320490383433794,0.8039854511279358],[0.9819684494356747,67,0.07876111907222547,0.7267951017503355,0.8306532482862891],[0.9812171353512827,68,0.0754894971830741,0.7302977253801978,0.8270055574418784],[0.9864763411071227,69,0.06913174633118642,0.7215411537791718,0.8227593964014704],[0.9834710860682286,70,0.0665552373961521,0.73380034901006,0.8695094548883455],[0.9879789710671807,71,0.0628518666232398,0.7092819585482836,0.8627580186635935],[0.9789631913068328,72,0.07407237324026811,0.7285464093898099,0.8207595569657361],[0.9887302851515726,73,0.06161906961477582,0.7302977295556544,0.8919084178065252],[0.9872276534002405,74,0.058568464302416585,0.7127845905290594,0.875135570607962],[0.9857250252314567,75,0.06321379290732738,0.7267950933994219,0.8760788863991271],[0.9917355414891404,76,0.05507354906625111,0.7180385271221034,0.9074985624507931],[0.9917355432804145,77,0.05114532946689428,0.7110332715114653,0.8990805205447034],[0.9887302851515726,78,0.04957110292168375,0.7197898377887839,0.8893040257869794],[0.9909842274047485,79,0.042332228698580894,0.7057793349184214,0.917629910590561],[0.9939894850409899,80,0.03698691625531503,0.7197898347615778,0.9517150845920141],[0.9902329133203566,81,0.0475109598550744,0.7197898419642407,0.9433516171579812],[0.9947408014092564,82,0.039136149168328,0.7215411579546286,0.9591721422096059],[0.9954921154936484,83,0.03591285390565263,0.7145358951413276,0.9496655156754362],[0.9917355432804145,84,0.038171906048007964,0.7092819555210775,0.9498430474835812],[0.9969947436624322,85,0.03686989266159479,0.7110332673360087,0.9570633652122551],[0.9939894819510422,86,0.034156400251330335,0.7075306353552329,0.9534567191596625],[0.9947408014092564,87,0.03410343523959438,0.714535903492241,0.9414592117018958],[0.9962434295780402,88,0.02801466240057096,0.7180385210676912,0.9851968747199938],[0.9932381732404725,89,0.030869491841255006,0.7145358909658709,1.042699944012637],[0.9932381714491983,90,0.028945202289175756,0.7162872111317156,1.0014374088593831],[0.9924868573648065,91,0.030767647648869734,0.7092819596965342,1.0007524145881266],[0.9939894873248644,92,0.028273654933025253,0.716287219482629,1.0260147845369296],[0.9939894855335903,93,0.025578068420962673,0.7127845875018533,1.0467111026760576],[0.9932381714491983,94,0.026351075141552827,0.7145358993167844,1.0592694585774283],[0.9977460577468241,95,0.025187737066340705,0.7162872069562588,1.0446311690552639],[0.9954921154936484,96,0.023049686880744463,0.7285464105380605,1.0417278311924842],[0.9962434295780402,97,0.024604233930616518,0.71803851877119,1.0908220127459791],[0.9909842287034222,98,0.030658910746506333,0.7162872069562588,1.0243997884924065],[0.9962434295780402,99,0.024941285366820807,0.7180385294186046,1.1067909366090745],[0.9954921137023742,100,0.027981076859760607,0.7127845821781459,1.047821370398727]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"acc","type":"\"double\"","metadata":"{}"},{"name":"epoch","type":"\"long\"","metadata":"{}"},{"name":"loss","type":"\"double\"","metadata":"{}"},{"name":"val_acc","type":"\"double\"","metadata":"{}"},{"name":"val_loss","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1524448943226,"submitTime":1524446628864,"finishTime":1524448943543,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"865.011364","height":"539.011364","xColumns":["epoch"],"yColumns":["val_loss","loss"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":0.3}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"783675f1-149b-4a86-935c-dbefa992aba7"},{"version":"CommandV1","origId":971216357823463,"guid":"f2e3e284-cb7b-4721-bac9-b1ec27767249","subtype":"command","commandType":"auto","position":10.98828125,"command":"%md\n##Test\n- ---\nBefore evaluate our model, we need to realize the standards, or, conditions of face recognition research area. As we know there are many out-standing solution of face recognition, like Fisher Vector Faces, DeepFace, Fusion, FaceNet, etc. \n\n![conv2d img](https://raw.githubusercontent.com/JunxiFan/Big-Data-Systems-and-Intelligence-Analytics/master/image_portfolio/faceRec_method_acc1.jpg)\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446628974,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e6ce7c62-ca3c-4b94-b85c-9d28c19c529f"},{"version":"CommandV1","origId":971216357823464,"guid":"919d480e-9717-4570-8db0-2aaa87df6c96","subtype":"command","commandType":"auto","position":10.990234375,"command":"%md\nUsing test dataset we generate before to evaluate our training result. Keras provides an evaluate function, use trained model and test set as parameters, it will return the value of loss and accuracy.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"58bf3e92-21b7-4639-97cf-5ab0540e3c7a"},{"version":"CommandV1","origId":971216357823465,"guid":"d16eab06-37c0-48b0-942b-729c0f89d499","subtype":"command","commandType":"auto","position":10.9921875,"command":"def evaluate(model, dataset):\n    score = MODEL.evaluate(dataset.test_images, dataset.test_labels, verbose = 1)\n    print('Test loss:', score[0])\n    print('Test accuracy:', score[1])\n#         print(type(score))\n    return score\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524448943555,"submitTime":1524446629104,"finishTime":1524448943629,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"23ef3407-79a9-4d67-873b-f025e56b6c29"},{"version":"CommandV1","origId":971216357823466,"guid":"8ed1f7d6-aee8-4b3c-8307-b3330e43f798","subtype":"command","commandType":"auto","position":10.99609375,"command":"evaluate(MODEL,dataset)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">\n 32/951 [&gt;.............................] - ETA: 2s\n 64/951 [=&gt;............................] - ETA: 2s\n 96/951 [==&gt;...........................] - ETA: 1s\n128/951 [===&gt;..........................] - ETA: 1s\n160/951 [====&gt;.........................] - ETA: 1s\n192/951 [=====&gt;........................] - ETA: 1s\n224/951 [======&gt;.......................] - ETA: 1s\n256/951 [=======&gt;......................] - ETA: 1s\n288/951 [========&gt;.....................] - ETA: 1s\n320/951 [=========&gt;....................] - ETA: 1s\n352/951 [==========&gt;...................] - ETA: 1s\n384/951 [===========&gt;..................] - ETA: 1s\n416/951 [============&gt;.................] - ETA: 0s\n448/951 [=============&gt;................] - ETA: 0s\n480/951 [==============&gt;...............] - ETA: 0s\n512/951 [===============&gt;..............] - ETA: 0s\n544/951 [================&gt;.............] - ETA: 0s\n576/951 [=================&gt;............] - ETA: 0s\n608/951 [==================&gt;...........] - ETA: 0s\n640/951 [===================&gt;..........] - ETA: 0s\n672/951 [====================&gt;.........] - ETA: 0s\n704/951 [=====================&gt;........] - ETA: 0s\n736/951 [======================&gt;.......] - ETA: 0s\n768/951 [=======================&gt;......] - ETA: 0s\n800/951 [========================&gt;.....] - ETA: 0s\n832/951 [=========================&gt;....] - ETA: 0s\n864/951 [==========================&gt;...] - ETA: 0s\n896/951 [===========================&gt;..] - ETA: 0s\n928/951 [============================&gt;.] - ETA: 0s\n951/951 [==============================] - 2s 2ms/step\n(&apos;Test loss:&apos;, 0.31391675709173883)\n(&apos;Test accuracy:&apos;, 0.9200841212874331)\n<span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>[0.31391675709173883, 0.9200841212874331]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1524448943633,"submitTime":1524446629217,"finishTime":1524448945450,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1b91520a-bb7b-496a-8274-36fe3de999d4"},{"version":"CommandV1","origId":971216357823467,"guid":"52640057-3a01-47da-9537-d696f67664e4","subtype":"command","commandType":"auto","position":12.0,"command":"%md\nThe result accuracy of test set is 0.91. Considering the amount of samples and the time we cost for training, this result is not bad..","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446629328,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"62f8c068-08b3-4728-9376-aa17527d6a1a"},{"version":"CommandV1","origId":971216357823468,"guid":"efedf7e9-0abd-45e3-a8c0-ad1f97474d05","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n##References\n\n1. [http://cis.csuohio.edu/~sschung/CIS660/DeepFaceRecognition_parkhi15.pdf]\n\n2. [https://www.microsoft.com/en-us/research/project/msra-cfw-data-set-of-celebrity-faces-on-the-web/?from=http%3A%2F%2Fresearch.microsoft.com%2Fen-us%2Fprojects%2Fmsra-cfw%2F]\n\n3.  [https://www.wikiwand.com/en/Databricks]\n\n4.  [https://docs.opencv.org/3.4.1/d1/dfb/intro.html]\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446629466,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"06af9cb5-1b04-4220-95d8-c62f5d82d784"},{"version":"CommandV1","origId":971216357823469,"guid":"6d011429-cffe-4e6d-8e4c-b3b60a49620c","subtype":"command","commandType":"auto","position":13.5,"command":"%md ##License\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446629579,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"93a5e16e-5941-432c-9dd9-cbe299b72ba1"},{"version":"CommandV1","origId":971216357823470,"guid":"1f327966-1b8f-47fa-99bc-a8c85502ff59","subtype":"command","commandType":"auto","position":14.0,"command":"%md\n####The text in the document by &lt;JUNXI FAN, KAIXIN GAO&gt; is licensed under CC BY 3.0 [https://creativecommons.org/licenses/by/3.0/us/]\n\nTHE WORK (AS DEFINED BELOW) IS PROVIDED UNDER THE TERMS OF THIS CREATIVE COMMONS PUBLIC LICENSE (\"CCPL\" OR \"LICENSE\"). THE WORK IS PROTECTED BY COPYRIGHT AND/OR OTHER APPLICABLE LAW. ANY USE OF THE WORK OTHER THAN AS AUTHORIZED UNDER THIS LICENSE OR COPYRIGHT LAW IS PROHIBITED.\n\nBY EXERCISING ANY RIGHTS TO THE WORK PROVIDED HERE, YOU ACCEPT AND AGREE TO BE BOUND BY THE TERMS OF THIS LICENSE. TO THE EXTENT THIS LICENSE MAY BE CONSIDERED TO BE A CONTRACT, THE LICENSOR GRANTS YOU THE RIGHTS CONTAINED HERE IN CONSIDERATION OF YOUR ACCEPTANCE OF SUCH TERMS AND CONDITIONS.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1524446629699,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e34c64a6-1e18-4562-b9bd-be8f1e260df0"},{"version":"CommandV1","origId":971216357823471,"guid":"71a0f807-e0a3-4cf1-b91f-11b852ae68f1","subtype":"command","commandType":"auto","position":15.0,"command":"%md\n####The code in the document by &lt;JUNXI FAN, KAIXIN GAO&gt; is licensed under the MIT License [https://opensource.org/licenses/MIT]\n\nCopyright &lt;2018&gt; &lt;JUNXI FAN, KAIXIN GAO&gt;\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","commandVersion":0,"state":"finished","results":null,"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":null,"workflows":[],"startTime":0,"submitTime":1524446629832,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"36e2c557-3ef6-483a-877d-c3feb7b40dce"}],"dashboards":[],"guid":"8bd4d605-3af5-45ac-aae6-18d2af670f81","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/dafda9f3df7d430fbaa0fa5d28080bc75e59001c1b8e417cba4151789385b12c/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
